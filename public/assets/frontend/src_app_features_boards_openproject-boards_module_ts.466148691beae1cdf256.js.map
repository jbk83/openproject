{"version":3,"mappings":"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","names":["constructor","e","n","i","r","a","c","d","l","h","g","m","this","placeholder","I18n","t","w","length","Nt","j","jt","U","querySpace","results","value","add","elements","map","f","id","F","query","filters","urlParamsHelper","buildV3GetFilters","merge","apiV3Service","withOptionalProject","CurrentProject","work_packages","filtered","get","pipe","$","notificationService","handleRawError","resource","getOptionsFn","getAutocompleterData","ngAfterViewInit","ngSelectComponent","ngSelectInstance","openSelect","focusSelect","wpCardDragDrop","removeReferenceWorkPackageForm","cancel","onCancel","emit","addWorkPackageToQuery","schemaCacheService","ensureLoaded","then","onReferenced","closeSelect","et","selectors","kt","St","super","reference","create","authorisationService","can","z","factory","disabled","canDelete","linkText","onClick","onRemove","board","isAction","actionService","getAdditionalListMenuItems","concat","boardActionRegistry","actionAttribute","boardService","canManage","delete","E","zt","getValueOr","I","Tt","updateSelection","selections$","next","selectionsForQuery","withinQuery","selections","Z","ue","Ot","re","Qt","Wn","Gn","Xn","Kn","to","eo","addCard","updateSuccessful","areYouSure","unnamed_list","click_to_remove","qt","addWorkPackage","canMove","ngOnInit","initiallyFocused","isNewWidget","state","includes","current","data","baseRoute","params","workPackageId","wpViewSelectionService","initializeSelection","observeUntil","subscribe","showAddButton","canDragInto","wpInlineCreate","canAdd","canReference","cdRef","detectChanges","updates$","Lt","untilDestroyed","Object","keys","_","pickBy","selected","wpViewFocusService","focusedWorkPackage","boardListCrossSelectionService","queryId","allSelected","boardFilters","values$","updateQuery","listenToActionAttributeChanges","canDragOutOf","updateOrderedWorkPackages","loadActionAttribute","ngOnDestroy","error_message","loadingError","updateImmediately","isFree","addReferenceCard","cardView","setReferenceMode","addNewCard","deleteList","window","confirm","text","apiv3Service","queries","renameQuery","inFlight","name","patch","toastService","addSuccess","boardListActionColorClass","Vt","showCardStatusButton","showStatusButton","refreshQueryUnlessCaused","causedUpdates","ve","setQueryProps","loadQuery","actionResource","headerComponent","getActionValueId","href","getLoadedActionValue","buttonPlaceholder","disabledAddButtonPlaceholder","actionResourceClass","dragIntoAllowed","canAddToQuery","halEditing","changeFor","assignToWorkPackage","isEmpty","cache","updateWorkPackage","save","options","toString","find","columnsQueryProps","Dt","indicatorInstance","wpStatesInitialization","updateQuerySpace","errorIdentifier","visibilityChange","halNotification","retrieveErrorMessage","loadingIndicator","indicator","jQuery","nativeElement","showHierarchies","pageSize","JSON","stringify","halEvents","events$","x","resourceType","eventType","commit","changes","filterName","from","openFullViewOnDoubleClick","double","go","openStateLink","requestedState","keepTab","goCurrentDetailsState","goCurrentShowState","schema","schemaCache","of","M","$t","provide","useClass","Ut","Et","open","items","buildItems","opContextMenu","show","positionArgs","assign","my","at","boardList","rt","onMove","cancelAnimationFrame","scrollTick","autoScroll","Math","setTimeout","scrollY","scrollX","y","destroy","De","log","reset","b","token","top","left","ngOnChanges","started","ended","entered","exited","handleScroll","destroyAutoScroll","getDropListRef","addDebugInfo","clientRect","color","dragFixContainer","_cacheOwnPosition","syncSiblings","syncItems","adjustContainers","adjustItems","_itemPositions","console","Q","L","type","dragConnectedIds","exportAs","args","scrollContainer","W","imports","isLocked","isClosed","version","G","highlighting_mode","description","none","priority","entire_card_by","onSave","updateMode","highlightingMode","locals","lastEntireCardAttribute","indexOf","entireCardMode","T","componentClass","_tabs","q","getActionFilter","values","qe","require","Promise","resolve","addInitialColumnsForAction","addColumnWithActionAttribute","operator","boardListsService","addQuery","loadAvailable","loadValues","filter","has","autocompleterComponent","Re","warningTextWhenNoOptionsAvailable","writable","isWritable","Error","attribute","humanName","Qe","injector","applyDefaultsFromFilters","J","putFromPromiseIfPristine","loadUncached","RegExp","test","ct","putValue","toPromise","status","dt","lt","all","isDefault","statuses","P","writable$","createWorkPackage","isOpen","currentProject","buildItemsForVersion","Ne","icon","Fe","projects","versions","patchVersionStatus","reload","hidden","$links","update","pathHelper","versionShowPath","versionEditPath","S","H","Kt","C","ot","monitor","Date","He","activeWindow","isActive","queryForUpdates","count","list","toISOString","N","assignee","pt","unassignedUser","memberships","link","projectMembershipsPath","identifier","available_assignees","O","Zt","project","ht","move","setValue","D","workPackage","typeHighlightingClass","ut","changeParent","B","it","gt","decls","Mt","create_new_board","boards","type_free","action_by_attribute","createdAt","deleteSuccessful","noResults","observeAll","sort","localeCompare","loadingIndicatorService","promise","loadAllBoards","newBoard","opModalService","en","destroyBoard","catch","addError","bt","board$","loadQueryForm","updateChecksumOnFilterChanges","wpTableFilters","push","live$","un","$state","query_props","custom","notify","form","loadWithParams","currentProjectService","updateStatesFromForm","ft","oe","title","closePopup","applyButton","cancelButton","$element","elementRef","tabPortalHost","fn","boardConfigurationService","tabs","tabContentOutlet","componentFactoryResolver","appRef","availableTabs","switchTo","dispose","currentTab","saveChanges","activeComponents","forEach","service","close","onClose","afterFocusOn","focus","vt","contextMenuId","grid","trigger","Rt","State","flash_message","message","_t","button_more","Ct","requests","handler","request","observe","responses$","R","unnamedBoard","addList","upsaleBoards","upsaleCheckOutLink","board_id","isNew","component","inputs","_n","toolbarDisabled","Boards","Cn","mn","containerClasses","bn","editable","boardSaver","removeTransitionSubscription","$transitions","onSuccess","showToolbarSaveButton","setPartition","titleService","setFirstPart","selectedTitle","parse","changeChangesFromTitle","updateTitleName","currentPartition","partition","X","ne","replace","active","ie","warnIfNoOptions","Zn","button_add","button_create","button_cancel","close_popup","free_board","free_board_text","action_board","action_board_text","select_attribute","Set","boardActions","autocompleterOptions","resourceName","toLowerCase","onModelChange","selectedAttribute","closeMe","onNewActionCreated","post","getVersionPayload","searchTerm","_links","definingProject","path","warningText","showWarning","xt","unnamedList","hiddenListWarning","teaser_text","upgrade_to_ee_text","more_info_link","Bn","Banner","eeShowBanners","_container","Drag","addScrollContainer","requireAndStream","setupQueryUpdatedMonitoring","currentBoard$","moveList","previousIndex","currentIndex","saveBoard","removeList","removeQuery","BoardList","addFreeQuery","showError","getActionFiltersFromWidget","changeVisibilityOfList","showHiddenListWarning","boardWidgets","boardComponent","currentQueryUpdatedMonitoring","unsubscribe","QueryUpdated","requestRefreshOfUpdatedLists","lists","widgets","yt","Pt","$n","parent","url","bodyClasses","menuItem","dynamic","redirectTo","inherit","reloadOnSearch","views","Vn","K","se","ae","ce","En","st","tt","states","config","o","urlService","rules","when","mt"],"sources":["./src/app/features/boards/board/inline-add/board-inline-add-autocompleter.component.ts","./src/app/features/boards/board/inline-add/board-inline-add-autocompleter.html","./src/app/features/boards/board/board-list/board-inline-create.service.ts","./src/app/features/boards/board/board-list/board-list-menu.component.html","./src/app/features/boards/board/board-list/board-list-menu.component.ts","./src/app/features/boards/board/board-filter/board-filters.service.ts","./src/app/features/boards/board/board-list/board-list-cross-selection.service.ts","./src/app/features/boards/board/board-list/board-list.component.html","./src/app/features/boards/board/board-list/board-list.component.ts","./src/app/features/boards/board/add-card-dropdown/add-card-dropdown-menu.directive.ts","./node_modules/cdk-drag-scroll/__ivy_ngcc__/fesm2015/cdk-drag-scroll.js","./src/app/features/boards/board/board-actions/version/version-board-header.html","./src/app/features/boards/board/board-actions/version/version-board-header.component.ts","./src/app/features/boards/board/configuration-modal/tabs/highlighting-tab.component.ts","./src/app/features/boards/board/configuration-modal/tabs/highlighting-tab.component.html","./src/app/features/boards/board/configuration-modal/board-configuration.service.ts","./src/app/features/boards/board/board-actions/board-action.service.ts","./src/app/features/boards/board/board-actions/cached-board-action.service.ts","./src/app/features/boards/board/board-actions/status/status-board-header.html","./src/app/features/boards/board/board-actions/status/status-board-header.component.ts","./src/app/features/boards/board/board-actions/status/status-action.service.ts","./src/app/features/boards/board/board-actions/version/version-action.service.ts","./src/app/features/boards/board/query-updated/query-updated.service.ts","./src/app/features/boards/board/board-actions/assignee/assignee-board-header.html","./src/app/features/boards/board/board-actions/assignee/assignee-board-header.component.ts","./src/app/features/boards/board/board-actions/assignee/assignee-action.service.ts","./src/app/features/boards/board/board-actions/subproject/subproject-board-header.html","./src/app/features/boards/board/board-actions/subproject/subproject-board-header.component.ts","./src/app/features/boards/board/board-actions/subproject/subproject-action.service.ts","./src/app/features/boards/board/board-actions/subtasks/subtasks-board-header.html","./src/app/features/boards/board/board-actions/subtasks/subtasks-board-header.component.ts","./src/app/features/boards/board/board-actions/subtasks/board-subtasks-action.service.ts","./src/app/features/boards/boards-root/boards-root.component.ts","./src/app/features/boards/index-page/boards-index-page.component.html","./src/app/features/boards/index-page/boards-index-page.component.ts","./src/app/features/boards/board/board-filter/board-filter.component.ts","./src/app/features/boards/board/board-filter/board-filter.component.html","./src/app/features/boards/board/configuration-modal/board-configuration.modal.ts","./src/app/features/boards/board/configuration-modal/board-configuration.modal.html","./src/app/features/boards/board/toolbar-menu/boards-toolbar-menu.directive.ts","./src/app/features/boards/board/toolbar-menu/boards-menu-button.component.ts","./src/app/shared/helpers/rxjs/request-switchmap.ts","./src/app/features/work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html","./src/app/features/boards/board/board-partitioned-page/board-partitioned-page.component.ts","./src/app/features/boards/board/add-list-modal/add-list-modal.html","./src/app/features/boards/board/add-list-modal/add-list-modal.component.ts","./src/app/features/boards/board/board-partitioned-page/board-list-container.component.html","./src/app/features/boards/board/board-partitioned-page/board-list-container.component.ts","./src/app/features/boards/openproject-boards.routes.ts","./src/app/features/boards/openproject-boards.module.ts"],"sourcesContent":["// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  AfterViewInit,\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  Input,\n  Output,\n  ViewChild,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, tap } from 'rxjs/operators';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { SchemaCacheService } from 'core-app/core/schemas/schema-cache.service';\nimport { WorkPackageCardDragAndDropService } from 'core-app/features/work-packages/components/wp-card-view/services/wp-card-drag-and-drop.service';\nimport { WorkPackageNotificationService } from 'core-app/features/work-packages/services/notifications/work-package-notification.service';\nimport { UrlParamsHelperService } from 'core-app/features/work-packages/components/wp-query/url-params-helper';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { ApiV3FilterBuilder } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { OpAutocompleterComponent } from 'core-app/shared/components/autocompleter/op-autocompleter/op-autocompleter.component';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { HalResourceService } from 'core-app/features/hal/services/hal-resource.service';\n\n@Component({\n  selector: 'board-inline-add-autocompleter',\n  templateUrl: './board-inline-add-autocompleter.html',\n\n  // Allow styling the embedded ng-select\n  encapsulation: ViewEncapsulation.None,\n  styleUrls: ['./board-inline-add-autocompleter.sass'],\n})\n\nexport class BoardInlineAddAutocompleterComponent implements AfterViewInit {\n  readonly text = {\n    placeholder: this.I18n.t('js.relations_autocomplete.placeholder'),\n  };\n\n  getAutocompleterData = (searchString:string):Observable<WorkPackageResource[]> => {\n    // Return when the search string is empty\n    if (searchString.length === 0) {\n      return of([]);\n    }\n\n    const filters:ApiV3FilterBuilder = new ApiV3FilterBuilder();\n    const results = this.querySpace.results.value;\n\n    filters.add('subjectOrId', '**', [searchString]);\n\n    if (results && results.elements.length > 0) {\n      filters.add('id', '!', results.elements.map((wp:WorkPackageResource) => wp.id!));\n    }\n    // Add the subproject filter, if any\n    const query = this.querySpace.query.value;\n    if (query?.filters) {\n      const currentFilters = this.urlParamsHelper.buildV3GetFilters(query.filters);\n      filters.merge(currentFilters, 'subprojectId');\n    }\n\n    return this\n      .apiV3Service\n      .withOptionalProject(this.CurrentProject.id)\n      .work_packages\n      .filtered(filters)\n      .get()\n      .pipe(\n        map((collection) => collection.elements),\n        catchError((error:unknown) => {\n          this.notificationService.handleRawError(error);\n          return of([]);\n        }),\n      );\n  };\n\n  public autocompleterOptions = {\n    resource: 'work_packages',\n    getOptionsFn: this.getAutocompleterData,\n  };\n\n  @Input() appendToContainer = 'body';\n\n  @ViewChild(OpAutocompleterComponent) public ngSelectComponent:OpAutocompleterComponent;\n\n  @Output() onCancel = new EventEmitter<undefined>();\n\n  @Output() onReferenced = new EventEmitter<WorkPackageResource>();\n\n  constructor(private readonly querySpace:IsolatedQuerySpace,\n    private readonly pathHelper:PathHelperService,\n    private readonly apiV3Service:ApiV3Service,\n    private readonly urlParamsHelper:UrlParamsHelperService,\n    private readonly notificationService:WorkPackageNotificationService,\n    private readonly CurrentProject:CurrentProjectService,\n    private readonly halResourceService:HalResourceService,\n    private readonly schemaCacheService:SchemaCacheService,\n    private readonly cdRef:ChangeDetectorRef,\n    private readonly I18n:I18nService,\n    private readonly wpCardDragDrop:WorkPackageCardDragAndDropService) {\n  }\n\n  ngAfterViewInit():void {\n    if (!this.ngSelectComponent.ngSelectInstance) {\n      return;\n    }\n    this.ngSelectComponent.openSelect();\n    this.ngSelectComponent.focusSelect();\n    this.wpCardDragDrop.removeReferenceWorkPackageForm();\n  }\n\n  cancel() {\n    this.onCancel.emit();\n  }\n\n  public addWorkPackageToQuery(workPackage?:WorkPackageResource) {\n    if (workPackage) {\n      this.schemaCacheService\n        .ensureLoaded(workPackage)\n        .then(() => {\n          this.onReferenced.emit(workPackage);\n          this.ngSelectComponent.closeSelect();\n        });\n    }\n  }\n}\n","<op-autocompleter\n  [appendTo]=\"appendToContainer\"\n  classes=\"wp-inline-create--reference-autocompleter\"\n  [closeOnSelect]=\"false\"\n  [placeholder]=\"text.placeholder\"\n  [resource]=\"autocompleterOptions.resource\"\n  [getOptionsFn]=\"autocompleterOptions.getOptionsFn\"\n  (close)=\"cancel()\"\n  (change)=\"addWorkPackageToQuery($event)\"\n></op-autocompleter>","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { Injectable, Injector } from '@angular/core';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { WorkPackageRelationsHierarchyService } from 'core-app/features/work-packages/components/wp-relations/wp-relations-hierarchy/wp-relations-hierarchy.service';\nimport { WorkPackageInlineCreateService } from 'core-app/features/work-packages/components/wp-inline-create/wp-inline-create.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { HalResourceService } from 'core-app/features/hal/services/hal-resource.service';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { BoardInlineAddAutocompleterComponent } from 'core-app/features/boards/board/inline-add/board-inline-add-autocompleter.component';\nimport { GonService } from 'core-app/core/gon/gon.service';\n\n@Injectable()\nexport class BoardInlineCreateService extends WorkPackageInlineCreateService {\n  constructor(readonly injector:Injector,\n    protected readonly querySpace:IsolatedQuerySpace,\n    protected readonly halResourceService:HalResourceService,\n    protected readonly pathHelperService:PathHelperService,\n    protected readonly Gon:GonService,\n    protected readonly wpRelationsHierarchyService:WorkPackageRelationsHierarchyService) {\n    super(injector);\n  }\n\n  /**\n   * A separate reference pane for the inline create component\n   */\n  public readonly referenceComponentClass = BoardInlineAddAutocompleterComponent;\n\n  /**\n   * A related work package for the inline create context\n   */\n  public referenceTarget:WorkPackageResource|null = null;\n\n  public get canAdd() {\n    return this.authorisationService.can('work_packages', 'createWorkPackage');\n  }\n\n  public get canReference() {\n    return this.authorisationService.can('work_packages', 'editWorkPackage');\n  }\n\n  /**\n   * Reference button text\n   */\n  public readonly buttonTexts = {\n    reference: this.I18n.t('js.relation_buttons.add_existing_child'),\n    create: this.I18n.t('js.relation_buttons.add_new_child'),\n  };\n}\n","<ng-container class=\"board-list--more-menu\" *ngIf=\"canDelete()\">\n  <icon-triggered-context-menu\n     [menu-items]=\"menuItems\">\n  </icon-triggered-context-menu>\n</ng-container>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  Component, EventEmitter, Input, Output,\n} from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { AuthorisationService } from 'core-app/core/model-auth/model-auth.service';\nimport { OpModalService } from 'core-app/shared/components/modal/modal.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { BoardActionsRegistryService } from 'core-app/features/boards/board/board-actions/board-actions-registry.service';\nimport { OpContextMenuItem } from 'core-app/shared/components/op-context-menu/op-context-menu.types';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { BoardActionService } from 'core-app/features/boards/board/board-actions/board-action.service';\n\n@Component({\n  selector: 'board-list-menu',\n  templateUrl: './board-list-menu.component.html',\n})\nexport class BoardListMenuComponent {\n  @Input() board:Board;\n\n  @Output() onRemove = new EventEmitter<void>();\n\n  constructor(readonly opModalService:OpModalService,\n    readonly authorisationService:AuthorisationService,\n    private readonly querySpace:IsolatedQuerySpace,\n    private readonly boardService:BoardService,\n    private readonly boardActionRegistry:BoardActionsRegistryService,\n    readonly I18n:I18nService) {\n  }\n\n  public get menuItems() {\n    return async () => {\n      const items:OpContextMenuItem[] = [\n        {\n          disabled: !this.canDelete,\n          linkText: this.I18n.t('js.boards.lists.delete'),\n          onClick: () => {\n            this.onRemove.emit();\n            return true;\n          },\n        },\n      ];\n\n      // Add action specific menu entries\n      if (this.board.isAction) {\n        const additional = await this.actionService.getAdditionalListMenuItems(this.query);\n        return items.concat(additional);\n      }\n\n      return items;\n    };\n  }\n\n  private get actionService():BoardActionService {\n    return this.boardActionRegistry.get(this.board.actionAttribute!);\n  }\n\n  private get canManage() {\n    return this.boardService.canManage(this.board);\n  }\n\n  public canDelete() {\n    return this.canManage && !!this.query.delete;\n  }\n\n  private get query() {\n    return this.querySpace.query.value!;\n  }\n}\n","import { input } from 'reactivestates';\nimport { Injectable } from '@angular/core';\nimport { ApiV3Filter } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\n\n@Injectable()\nexport class BoardFiltersService {\n  /**\n   * We need to remember the current filter, that may either come\n   * from the saved board, or were assigned by the user.\n   *\n   * This is due to the fact we do not work on an query object here.\n   */\n  filters = input<ApiV3Filter[]>([]);\n\n  get current():ApiV3Filter[] {\n    return this.filters.getValueOr([]);\n  }\n}\n","import { Observable, Subject } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\n\nexport interface BoardSelection {\n  /** The query that the selection happened in */\n  withinQuery:string;\n\n  /** The focused selected work package */\n  focusedWorkPackage:string|null;\n\n  /** Array of selected work packages */\n  allSelected:string[];\n}\n\n/**\n * Responsible for keeping selected items across all lists of a board,\n * selections in one list will propagate to other lists as well.\n */\n@Injectable()\nexport class BoardListCrossSelectionService {\n  private selections$ = new Subject<BoardSelection>();\n\n  /**\n   * Marks the selection of one or multiple cards within a list\n   * by a user.\n   *\n   * The primary selected should be open in split screen (if open).\n   *\n   */\n  updateSelection(selection:BoardSelection) {\n    this.selections$.next(selection);\n  }\n\n  /**\n   * Returns an observable for a given query that fires\n   * when its selection should be updated.\n   *\n   * @param id\n   */\n  selectionsForQuery(id:string):Observable<BoardSelection> {\n    return this\n      .selections$\n      .pipe(\n        filter((selection) => selection.withinQuery !== id),\n      );\n  }\n\n  selections():Observable<BoardSelection> {\n    return this.selections$;\n  }\n}\n","<div #loadingIndicator\n     [attr.data-query-name]=\"listName\"\n     class=\"op-board-list loading-indicator--location\"\n     data-qa-selector=\"op-board-list\"\n     [ngClass]=\"{ '-action-list': board.isAction }\">\n  <ng-container *ngIf=\"query\">\n\n    <div *ngIf=\"board.isAction\"\n         class=\"op-board-list--action-bar\"\n         [ngClass]=\"actionResourceClass\">\n    </div>\n\n    <div class=\"op-board-list--header\"\n          data-qa-selector=\"op-board-list--header\">\n      <ndc-dynamic *ngIf=\"headerComponent\"\n                   [ndcDynamicComponent]=\"headerComponent\"\n                   [ndcDynamicInputs]=\"{ resource: actionResource }\">\n      </ndc-dynamic>\n      <editable-toolbar-title *ngIf=\"!headerComponent\"\n                              [title]=\"query.name\"\n                              [smallHeader]=\"true\"\n                              [inFlight]=\"inFlight\"\n                              (onSave)=\"renameQuery(query, $event)\"\n                              [editable]=\"canRename\"\n                              [initialFocus]=\"initiallyFocused\"\n                              class=\"-small\">\n      </editable-toolbar-title>\n\n      <board-list-menu class=\"op-board-list--menu\"\n                       data-qa-selector=\"op-board-list--menu\"\n                       [board]=\"board\"\n                       (onRemove)=\"deleteList()\">\n      </board-list-menu>\n    </div>\n\n    <div class=\"op-board-list--query-container drop-zone\"\n         [ngClass]=\"{ '-with-create-button': board.isAction || showAddButton }\">\n      <div class=\"op-board-list--button-container\">\n        <button [title]=\"text.addCard\"\n                *ngIf=\"showAddButton\"\n                data-qa-selector=\"op-board-list--card-dropdown-add-button\"\n                class=\"op-board-list--add-button op-board-list--card-dropdown-button button\"\n                op-addCardDropdown>\n          <op-icon icon-classes=\"icon-small icon-add\"></op-icon>\n        </button>\n      </div>\n\n      <wp-card-view [dragOutOfHandler]=\"canDragOutOfHandler\"\n                    [dragInto]=\"canDragInto\"\n                    [workPackageAddedHandler]=\"workPackageAddedHandler\"\n                    [cardsRemovable]=\"board.isFree && canDragOutOf\"\n                    [showInfoButton]=\"true\"\n                    [highlightingMode]=\"board.highlightingMode\"\n                    [showStatusButton]=\"showCardStatusButton()\"\n                    (itemClicked)=\"openFullViewOnDoubleClick($event)\"\n                    (stateLinkClicked)=\"openStateLink($event)\">\n\n      </wp-card-view>\n    </div>\n  </ng-container>\n  <div class=\"op-board-list--toaster-box -error\" *ngIf=\"loadingError\">\n    <p>\n      <span [textContent]=\"errorMessage\"></span>\n      &ngsp;\n      <buton\n        type=\"button\"\n        class=\"spot-link\"\n        (click)=\"onRemove.emit()\"\n      >\n        <span [textContent]=\"text.click_to_remove\"></span>\n      </buton>\n    </p>\n  </div>\n</div>\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Injector,\n  Input,\n  OnDestroy,\n  OnInit,\n  Output,\n  ViewChild,\n} from '@angular/core';\nimport {\n  LoadingIndicatorService,\n  withLoadingIndicator,\n} from 'core-app/core/loading-indicator/loading-indicator.service';\nimport { WorkPackageInlineCreateService } from 'core-app/features/work-packages/components/wp-inline-create/wp-inline-create.service';\nimport { BoardInlineCreateService } from 'core-app/features/boards/board/board-list/board-inline-create.service';\nimport { AbstractWidgetComponent } from 'core-app/shared/components/grids/widgets/abstract-widget.component';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { ToastService } from 'core-app/shared/components/toaster/toast.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { AuthorisationService } from 'core-app/core/model-auth/model-auth.service';\nimport { Highlighting } from 'core-app/features/work-packages/components/wp-fast-table/builders/highlighting/highlighting.functions';\nimport { WorkPackageCardViewComponent } from 'core-app/features/work-packages/components/wp-card-view/wp-card-view.component';\nimport { WorkPackageStatesInitializationService } from 'core-app/features/work-packages/components/wp-list/wp-states-initialization.service';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { HalResourceEditingService } from 'core-app/shared/components/fields/edit/services/hal-resource-editing.service';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { BoardActionsRegistryService } from 'core-app/features/boards/board/board-actions/board-actions-registry.service';\nimport { BoardActionService } from 'core-app/features/boards/board/board-actions/board-action.service';\nimport { ComponentType } from '@angular/cdk/portal';\nimport { CausedUpdatesService } from 'core-app/features/boards/board/caused-updates/caused-updates.service';\nimport { BoardListMenuComponent } from 'core-app/features/boards/board/board-list/board-list-menu.component';\nimport { debugLog } from 'core-app/shared/helpers/debug_output';\nimport { WorkPackageCardDragAndDropService } from 'core-app/features/work-packages/components/wp-card-view/services/wp-card-drag-and-drop.service';\nimport { componentDestroyed } from '@w11k/ngx-componentdestroyed';\nimport { BoardFiltersService } from 'core-app/features/boards/board/board-filter/board-filters.service';\nimport { StateService, TransitionService } from '@uirouter/core';\nimport { WorkPackageViewFocusService } from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-focus.service';\nimport { WorkPackageViewSelectionService } from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-selection.service';\nimport { BoardListCrossSelectionService } from 'core-app/features/boards/board/board-list/board-list-cross-selection.service';\nimport {\n  debounceTime, filter, map, retry,\n} from 'rxjs/operators';\nimport { ChangeItem } from 'core-app/shared/components/fields/changeset/changeset';\nimport { WorkPackageChangeset } from 'core-app/features/work-packages/components/wp-edit/work-package-changeset';\nimport { SchemaCacheService } from 'core-app/core/schemas/schema-cache.service';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { ApiV3Filter } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { KeepTabService } from 'core-app/features/work-packages/components/wp-single-view-tabs/keep-tab/keep-tab.service';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { HalEvent, HalEventsService } from 'core-app/features/hal/services/hal-events.service';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\n\nexport interface DisabledButtonPlaceholder {\n  text:string;\n  icon:string;\n}\n\n@Component({\n  selector: 'board-list',\n  templateUrl: './board-list.component.html',\n  styleUrls: ['./board-list.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    { provide: WorkPackageInlineCreateService, useClass: BoardInlineCreateService },\n    BoardListMenuComponent,\n    WorkPackageCardDragAndDropService,\n  ],\n})\nexport class BoardListComponent extends AbstractWidgetComponent implements OnInit, OnDestroy {\n  /** Output fired upon query removal */\n  @Output() onRemove = new EventEmitter<void>();\n\n  /* Output fired after it is assured whether a user has the right to see the list */\n  @Output() visibilityChange = new EventEmitter<boolean>();\n\n  /** Access to the board resource */\n  @Input() public board:Board;\n\n  /** Access to the loading indicator element */\n  @ViewChild('loadingIndicator', { static: true }) indicator:ElementRef;\n\n  /** Access to the card view */\n  @ViewChild(WorkPackageCardViewComponent) cardView:WorkPackageCardViewComponent;\n\n  /** The query resource being loaded */\n  public query:QueryResource;\n\n  /** Query loading error, if present */\n  public loadingError:string|undefined;\n\n  /** The action attribute resource if any */\n  public actionResource:HalResource|undefined;\n\n  public actionResourceClass = '';\n\n  public headerComponent:ComponentType<unknown>|undefined;\n\n  /** Rename inFlight */\n  public inFlight:boolean;\n\n  /** Whether the add button should be shown */\n  public showAddButton = false;\n\n  public columnsQueryProps:any;\n\n  public text = {\n    addCard: this.I18n.t('js.boards.add_card'),\n    updateSuccessful: this.I18n.t('js.notice_successful_update'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    unnamed_list: this.I18n.t('js.boards.label_unnamed_list'),\n    click_to_remove: this.I18n.t('js.boards.click_to_remove_list'),\n  };\n\n  /** Are we allowed to remove and drag & drop elements ? */\n  public canDragInto = false;\n\n  /** Initially focus the list */\n  public initiallyFocused = false;\n\n  /** Editing handler to be passed into card component */\n  public workPackageAddedHandler = (workPackage:WorkPackageResource) => this.addWorkPackage(workPackage);\n\n  /** Move check to be passed into card component */\n  public canDragOutOf = false;\n\n  public canDragOutOfHandler = (workPackage:WorkPackageResource) => this.canMove(workPackage);\n\n  public buttonPlaceholder:DisabledButtonPlaceholder|undefined;\n\n  constructor(readonly apiv3Service:ApiV3Service,\n    readonly I18n:I18nService,\n    readonly state:StateService,\n    readonly cdRef:ChangeDetectorRef,\n    readonly transitions:TransitionService,\n    readonly boardFilters:BoardFiltersService,\n    readonly toastService:ToastService,\n    readonly querySpace:IsolatedQuerySpace,\n    readonly halNotification:HalResourceNotificationService,\n    readonly halEvents:HalEventsService,\n    readonly wpStatesInitialization:WorkPackageStatesInitializationService,\n    readonly wpViewFocusService:WorkPackageViewFocusService,\n    readonly wpViewSelectionService:WorkPackageViewSelectionService,\n    readonly boardListCrossSelectionService:BoardListCrossSelectionService,\n    readonly authorisationService:AuthorisationService,\n    readonly wpInlineCreate:WorkPackageInlineCreateService,\n    readonly injector:Injector,\n    readonly halEditing:HalResourceEditingService,\n    readonly loadingIndicator:LoadingIndicatorService,\n    readonly schemaCache:SchemaCacheService,\n    readonly boardService:BoardService,\n    readonly boardActionRegistry:BoardActionsRegistryService,\n    readonly causedUpdates:CausedUpdatesService,\n    readonly keepTab:KeepTabService,\n    readonly $state:StateService) {\n    super(I18n, injector);\n  }\n\n  ngOnInit():void {\n    // Unset the isNew flag\n    this.initiallyFocused = this.resource.isNewWidget;\n    this.resource.isNewWidget = false;\n\n    // Set initial selection if split view open\n    if (this.state.includes(`${this.state.current.data.baseRoute}.details`)) {\n      const wpId = this.state.params.workPackageId;\n      this.wpViewSelectionService.initializeSelection([wpId]);\n    }\n\n    // Update permission on model updates\n    this.authorisationService\n      .observeUntil(componentDestroyed(this))\n      .subscribe(() => {\n        if (!this.board.isAction) {\n          this.showAddButton = this.canDragInto && (this.wpInlineCreate.canAdd || this.canReference);\n          this.cdRef.detectChanges();\n        }\n      });\n\n    // If this query space changes its focused or selected\n    // work packages, update the board cross selection\n    this.wpViewSelectionService\n      .updates$()\n      .pipe(\n        debounceTime(100),\n        this.untilDestroyed(),\n      ).subscribe((selectionState) => {\n        const selected = Object.keys(_.pickBy(selectionState.selected, (selected, _) => selected === true));\n\n        const focused = this.wpViewFocusService.focusedWorkPackage;\n\n        this.boardListCrossSelectionService.updateSelection({\n          withinQuery: this.queryId,\n          focusedWorkPackage: focused,\n          allSelected: selected,\n        });\n      });\n\n    // Apply focus and selection when changed in cross service\n    this.boardListCrossSelectionService\n      .selectionsForQuery(this.queryId)\n      .pipe(\n        this.untilDestroyed(),\n      )\n      .subscribe((selection) => {\n        this.wpViewSelectionService.initializeSelection(selection.allSelected);\n      });\n\n    // Update query on filter change\n    this.boardFilters\n      .filters\n      .values$()\n      .pipe(\n        this.untilDestroyed(),\n      )\n      .subscribe(() => this.updateQuery(true));\n\n    // Listen to changes to action attribute\n    this.listenToActionAttributeChanges();\n\n    this.querySpace.query\n      .values$()\n      .pipe(\n        this.untilDestroyed(),\n      )\n      .subscribe((query) => {\n        this.query = query;\n        this.canDragOutOf = !!this.query.updateOrderedWorkPackages;\n        this.loadActionAttribute(query);\n        this.cdRef.detectChanges();\n      });\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n  }\n\n  public get errorMessage() {\n    return this.I18n.t('js.boards.error_loading_the_list', { error_message: this.loadingError });\n  }\n\n  public canMove(workPackage:WorkPackageResource) {\n    return this.canDragOutOf && (!this.actionService || this.actionService.canMove(workPackage));\n  }\n\n  public get canReference() {\n    return this.wpInlineCreate.canReference;\n  }\n\n  public get canManage() {\n    return this.boardService.canManage(this.board);\n  }\n\n  public get canRename() {\n    return this.canManage\n      && !!this.query.updateImmediately\n      && this.board.isFree;\n  }\n\n  public addReferenceCard() {\n    this.cardView.setReferenceMode(true);\n  }\n\n  public addNewCard() {\n    this.cardView.addNewCard();\n  }\n\n  public deleteList(query?:QueryResource) {\n    query = query || this.query;\n\n    if (!window.confirm(this.text.areYouSure)) {\n      return;\n    }\n\n    this\n      .apiv3Service\n      .queries\n      .id(query)\n      .delete()\n      .subscribe(() => this.onRemove.emit());\n  }\n\n  public renameQuery(query:QueryResource, value:string) {\n    this.inFlight = true;\n    this.query.name = value;\n    this\n      .apiv3Service\n      .queries\n      .id(this.query)\n      .patch({ name: value })\n      .subscribe(\n        () => {\n          this.inFlight = false;\n          this.toastService.addSuccess(this.text.updateSuccessful);\n        },\n        (_error) => this.inFlight = false,\n      );\n  }\n\n  private boardListActionColorClass(value?:HalResource):string {\n    const attribute = this.board.actionAttribute!;\n    if (value && value.id) {\n      return Highlighting.backgroundClass(attribute, value.id);\n    }\n    return '';\n  }\n\n  public get listName() {\n    return this.query && this.query.name;\n  }\n\n  public showCardStatusButton() {\n    return this.board.showStatusButton();\n  }\n\n  public refreshQueryUnlessCaused(query:QueryResource, visibly = true) {\n    if (!this.causedUpdates.includes(query)) {\n      debugLog(`Refreshing ${query.name} visibly due to external changes`);\n      this.updateQuery(visibly);\n    }\n  }\n\n  public updateQuery(visibly = true) {\n    this.setQueryProps(this.boardFilters.current);\n    this.loadQuery(visibly);\n  }\n\n  private loadActionAttribute(query:QueryResource) {\n    if (!this.board.isAction) {\n      this.actionResource = undefined;\n      this.headerComponent = undefined;\n      this.canDragInto = !!query.updateOrderedWorkPackages;\n      return;\n    }\n\n    const actionService = this.actionService!;\n    const id = actionService.getActionValueId(query);\n\n    // Test if we loaded the resource already\n    if (this.actionResource && id === this.actionResource.href) {\n      return;\n    }\n\n    // Load the resource\n    actionService.getLoadedActionValue(query).then(async (resource) => {\n      this.actionResource = resource;\n      this.headerComponent = actionService.headerComponent();\n      this.buttonPlaceholder = actionService.disabledAddButtonPlaceholder(resource);\n      this.actionResourceClass = this.boardListActionColorClass(resource);\n      this.canDragInto = actionService.dragIntoAllowed(query, resource);\n\n      const canWriteAttribute = await actionService.canAddToQuery(query);\n      this.showAddButton = this.canDragInto && this.wpInlineCreate.canAdd && canWriteAttribute;\n      this.cdRef.detectChanges();\n    });\n  }\n\n  /**\n   * Return the linked action service\n   */\n  private get actionService():BoardActionService|undefined {\n    if (this.board.actionAttribute) {\n      return this.boardActionRegistry.get(this.board.actionAttribute);\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Handler to properly update the work package, when\n   * adding to this query requires saving a changeset.\n   * @param workPackage\n   */\n  private addWorkPackage(workPackage:WorkPackageResource) {\n    const query = this.querySpace.query.value!;\n    const changeset:WorkPackageChangeset = this.halEditing.changeFor(workPackage);\n\n    // Assign to the action attribute if this is an action board\n    this.actionService?.assignToWorkPackage(changeset, query);\n\n    if (changeset.isEmpty()) {\n      // Ensure work package and its schema is loaded\n      return this.apiv3Service.work_packages.cache.updateWorkPackage(workPackage);\n    }\n    // Save changes to the work package, which reloads it as well\n    return this.halEditing.save(changeset);\n  }\n\n  private get queryId():string {\n    return (this.resource.options.queryId as number|string).toString();\n  }\n\n  private loadQuery(visibly = true) {\n    let observable = this\n      .apiv3Service\n      .queries\n      .find(this.columnsQueryProps, this.queryId);\n\n    // Spread arguments on pipe does not work:\n    // https://github.com/ReactiveX/rxjs/issues/3989\n    if (visibly) {\n      observable = observable.pipe(withLoadingIndicator(this.indicatorInstance, 50));\n    }\n\n    observable\n      .subscribe(\n        (query) => {\n          this.wpStatesInitialization.updateQuerySpace(query, query.results);\n        },\n        (error) => {\n          const userIsNotAllowedToSeeSubprojectError = 'urn:openproject-org:api:v3:errors:InvalidQuery';\n          if(error.errorIdentifier === userIsNotAllowedToSeeSubprojectError) {\n            this.visibilityChange.emit(false);\n          }\n          this.loadingError = this.halNotification.retrieveErrorMessage(error);\n          this.cdRef.detectChanges();\n        },\n      );\n  }\n\n  private get indicatorInstance() {\n    return this.loadingIndicator.indicator(jQuery(this.indicator.nativeElement));\n  }\n\n  private setQueryProps(filters:ApiV3Filter[]) {\n    const existingFilters = (this.resource.options.filters || []) as ApiV3Filter[];\n\n    const newFilters = existingFilters.concat(filters);\n    const newColumnsQueryProps:any = {\n      'columns[]': ['id', 'subject'],\n      showHierarchies: false,\n      pageSize: 500,\n      filters: JSON.stringify(newFilters),\n    };\n\n    this.columnsQueryProps = newColumnsQueryProps;\n  }\n\n  private listenToActionAttributeChanges() {\n    // If we don't have an action attribute\n    // nothing to do\n    if (!this.board.actionAttribute) {\n      return;\n    }\n\n    // Listen to hal events to detect changes to an action attribute\n    this.halEvents\n      .events$\n      .pipe(\n        filter((event) => event.resourceType === 'WorkPackage'),\n        // Only allow updates, otherwise this causes an error reloading the list\n        // before the work package can be added to the query order\n        filter((event) => event.eventType === 'updated'),\n        map((event:HalEvent) => event.commit?.changes[this.actionService!.filterName]),\n        filter((value) => !!value),\n        filter((value:ChangeItem) => {\n          // Compare the from and to values from the committed changes\n          // with the current actionResource\n          const current = this.actionResource?.href;\n          const to = (value.to as HalResource|undefined)?.href;\n          const from = (value.from as HalResource|undefined)?.href;\n\n          return !!current && (current === to || current === from);\n        }),\n      ).subscribe((event) => {\n        this.updateQuery(true);\n      });\n  }\n\n  openFullViewOnDoubleClick(event:{ workPackageId:string, double:boolean }) {\n    if (event.double) {\n      this.state.go(\n        'work-packages.show',\n        { workPackageId: event.workPackageId },\n      );\n    }\n  }\n\n  openStateLink(event:{ workPackageId:string; requestedState:string }) {\n    const params = { workPackageId: event.workPackageId };\n\n    if (event.requestedState === 'split') {\n      this.keepTab.goCurrentDetailsState(params);\n    } else {\n      this.keepTab.goCurrentShowState(params);\n    }\n  }\n\n  private schema(workPackage:WorkPackageResource) {\n    return this.schemaCache.of(workPackage);\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectorRef, Directive, ElementRef, Injector,\n} from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { AuthorisationService } from 'core-app/core/model-auth/model-auth.service';\nimport { OpContextMenuTrigger } from 'core-app/shared/components/op-context-menu/handlers/op-context-menu-trigger.directive';\nimport { OPContextMenuService } from 'core-app/shared/components/op-context-menu/op-context-menu.service';\nimport { OpModalService } from 'core-app/shared/components/modal/modal.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { WorkPackageInlineCreateService } from 'core-app/features/work-packages/components/wp-inline-create/wp-inline-create.service';\nimport { BoardListComponent } from 'core-app/features/boards/board/board-list/board-list.component';\n\n@Directive({\n  selector: '[op-addCardDropdown]',\n})\nexport class AddCardDropdownMenuDirective extends OpContextMenuTrigger {\n  constructor(readonly elementRef:ElementRef,\n    readonly opContextMenu:OPContextMenuService,\n    readonly opModalService:OpModalService,\n    readonly authorisationService:AuthorisationService,\n    readonly wpInlineCreate:WorkPackageInlineCreateService,\n    readonly boardList:BoardListComponent,\n    readonly injector:Injector,\n    readonly querySpace:IsolatedQuerySpace,\n    readonly cdRef:ChangeDetectorRef,\n    readonly I18n:I18nService) {\n    super(elementRef, opContextMenu);\n  }\n\n  protected open(evt:JQuery.TriggeredEvent) {\n    this.items = this.buildItems();\n    this.opContextMenu.show(this, evt);\n  }\n\n  /**\n   * Positioning args for jquery-ui position.\n   *\n   * @param {Event} openerEvent\n   */\n  public positionArgs(evt:JQuery.TriggeredEvent) {\n    const additionalPositionArgs = {\n      my: 'left top',\n      at: 'left bottom',\n    };\n\n    const position = super.positionArgs(evt);\n    _.assign(position, additionalPositionArgs);\n\n    return position;\n  }\n\n  private buildItems() {\n    return [\n      {\n        disabled: !this.wpInlineCreate.canAdd,\n        linkText: this.I18n.t('js.card.add_new'),\n        onClick: () => {\n          this.boardList.addNewCard();\n          return true;\n        },\n      },\n      {\n        disabled: !this.wpInlineCreate.canReference,\n        linkText: this.I18n.t('js.relation_buttons.add_existing'),\n        onClick: () => {\n          this.boardList.addReferenceCard();\n          return true;\n        },\n      },\n    ];\n  }\n}\n","import { CdkDrag, DragDropModule } from '@angular/cdk/drag-drop';\nimport { Injectable, defineInjectable, Directive, NgZone, ChangeDetectorRef, Input, NgModule } from '@angular/core';\nimport { BehaviorSubject, Subject, fromEvent } from 'rxjs';\nimport { takeUntil, debounceTime } from 'rxjs/operators';\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nimport * as ngcc0 from '@angular/core';\nimport * as ngcc1 from '@angular/cdk/drag-drop';\nclass AutoScroll {\r\n    /**\r\n     * @param {?} container\r\n     * @param {?=} scrollCallback\r\n     */\r\n    constructor(container, scrollCallback) {\r\n        this.container = container;\r\n        this.scrollCallback = scrollCallback;\r\n        this.margin = 30;\r\n        this.maxSpeed = 25;\r\n        this.point = { x: 0, y: 0 };\r\n        this.boundaryRect = this.container.getBoundingClientRect();\r\n    }\r\n    /**\r\n     * @param {?} point\r\n     * @return {?}\r\n     */\r\n    onMove(point) {\r\n        this.point = point;\r\n        cancelAnimationFrame(this.animationFrame);\r\n        this.animationFrame = requestAnimationFrame((/**\r\n         * @return {?}\r\n         */\r\n        () => this.scrollTick()));\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    scrollTick() {\r\n        cancelAnimationFrame(this.animationFrame);\r\n        if (this.autoScroll()) {\r\n            this.animationFrame = requestAnimationFrame((/**\r\n             * @return {?}\r\n             */\r\n            () => this.scrollTick()));\r\n        }\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    autoScroll() {\r\n        /** @type {?} */\r\n        let scrollx;\r\n        /** @type {?} */\r\n        let scrolly;\r\n        if (this.point.x < this.boundaryRect.left + this.margin) {\r\n            scrollx = Math.floor(Math.max(-1, (this.point.x - this.boundaryRect.left) / this.margin - 1) * this.maxSpeed);\r\n        }\r\n        else if (this.point.x > this.boundaryRect.right - this.margin) {\r\n            scrollx = Math.ceil(Math.min(1, (this.point.x - this.boundaryRect.right) / this.margin + 1) * this.maxSpeed);\r\n        }\r\n        else {\r\n            scrollx = 0;\r\n        }\r\n        if (this.point.y < this.boundaryRect.top + this.margin) {\r\n            scrolly = Math.floor(Math.max(-1, (this.point.y - this.boundaryRect.top) / this.margin - 1) *\r\n                this.maxSpeed);\r\n        }\r\n        else if (this.point.y > this.boundaryRect.bottom - this.margin) {\r\n            scrolly = Math.ceil(Math.min(1, (this.point.y - this.boundaryRect.bottom) / this.margin + 1) * this.maxSpeed);\r\n        }\r\n        else {\r\n            scrolly = 0;\r\n        }\r\n        setTimeout((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            if (scrolly) {\r\n                this.scrollY(scrolly);\r\n            }\r\n            if (scrollx) {\r\n                this.scrollX(scrollx);\r\n            }\r\n        }));\r\n        return scrollx || scrolly;\r\n    }\r\n    /**\r\n     * @param {?} amount\r\n     * @return {?}\r\n     */\r\n    scrollY(amount) {\r\n        // ToDo for window: window.scrollTo(window.pageXOffset, window.pageYOffset + amount);\r\n        this.container.scrollTop += amount;\r\n        if (this.scrollCallback) {\r\n            this.scrollCallback({ x: 0, y: amount });\r\n        }\r\n    }\r\n    /**\r\n     * @param {?} amount\r\n     * @return {?}\r\n     */\r\n    scrollX(amount) {\r\n        // ToDo for window: window.scrollTo(window.pageXOffset + amount, window.pageYOffset);\r\n        this.container.scrollLeft += amount;\r\n        if (this.scrollCallback) {\r\n            this.scrollCallback({\r\n                x: amount,\r\n                y: 0\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    destroy() {\r\n        cancelAnimationFrame(this.animationFrame);\r\n    }\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass DragDebugService {\r\n    constructor() {\r\n        this.debugInfo = new BehaviorSubject(null);\r\n        this.enabled = false;\r\n    }\r\n    /**\r\n     * @param {?} info\r\n     * @return {?}\r\n     */\r\n    log(info) {\r\n        this.debugInfo.next(info);\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    reset() {\r\n        this.debugInfo.next(null);\r\n    }\r\n}\nDragDebugService.fac = function DragDebugService_Factory(t) { return new (t || DragDebugService)(); };\nDragDebugService.prov = /*@__PURE__*/ ngcc0.defineInjectable({ token: DragDebugService, factory: DragDebugService.fac, providedIn: 'root' });\r\n/** @nocollapse */\r\nDragDebugService.ctorParameters = () => [];\r\n/** @nocollapse */ DragDebugService.ngInjectableDef = defineInjectable({ factory: function DragDebugService_Factory() { return new DragDebugService(); }, token: DragDebugService, providedIn: \"root\" });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ngcc0.setClassMetadata(DragDebugService, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], function () { return []; }, null); })();\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template T\r\n */\r\nclass DragScrollDirective {\r\n    /**\r\n     * @param {?} cdkDrag\r\n     * @param {?} dragDebugService\r\n     * @param {?} zone\r\n     * @param {?} changeDetectorRef\r\n     */\r\n    constructor(cdkDrag, dragDebugService, zone, changeDetectorRef) {\r\n        this.cdkDrag = cdkDrag;\r\n        this.dragDebugService = dragDebugService;\r\n        this.zone = zone;\r\n        this.changeDetectorRef = changeDetectorRef;\r\n        this.destroy$ = new Subject();\r\n        this.stopDragging$ = new Subject();\r\n        this.lastScroll = {\r\n            top: 0,\r\n            left: 0\r\n        };\r\n        this.dragRef = this.cdkDrag['_dragRef'];\r\n        if (this.dragRef) {\r\n            this.zone.runOutsideAngular((/**\r\n             * @return {?}\r\n             */\r\n            () => {\r\n                this.dragRef.started.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Started', event, this.dragRef.isDragging());\r\n                    this.started();\r\n                }));\r\n                this.dragRef.ended.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Ended', event);\r\n                    this.ended();\r\n                }));\r\n                this.dragRef.entered.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Entered', event);\r\n                    this.entered();\r\n                }));\r\n                this.dragRef.exited.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Exited', event);\r\n                    this.exited();\r\n                }));\r\n            }));\r\n        }\r\n        else {\r\n            this.log('CdkDrag not found', this.cdkDrag, this.dragRef);\r\n        }\r\n    }\r\n    /**\r\n     * @param {?} changes\r\n     * @return {?}\r\n     */\r\n    ngOnChanges(changes) {\r\n        if (changes.dragConnectedIds) {\r\n            if (this.dragRef.isDragging()) {\r\n                // https://github.com/angular/material2/issues/15343\r\n                setTimeout((/**\r\n                 * @return {?}\r\n                 */\r\n                () => {\r\n                    this.syncSiblings();\r\n                }));\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    ngOnDestroy() {\r\n        this.destroy$.next();\r\n        this.destroy$.complete();\r\n        this.stopDragging$.next();\r\n        this.stopDragging$.complete();\r\n        this.destroyAutoScroll();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    started() {\r\n        if (!this.scrollContainer) {\r\n            return;\r\n        }\r\n        this.destroyAutoScroll();\r\n        this.addDebugInfo();\r\n        this.autoScroll = new AutoScroll(this.scrollContainer);\r\n        this.lastScroll.top = this.scrollContainer.scrollTop;\r\n        this.lastScroll.left = this.scrollContainer.scrollLeft;\r\n        fromEvent(this.scrollContainer, 'scroll')\r\n            .pipe(takeUntil(this.stopDragging$))\r\n            .subscribe((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            /** @type {?} */\r\n            const deltaX = this.scrollContainer.scrollLeft - this.lastScroll.left;\r\n            /** @type {?} */\r\n            const deltaY = this.scrollContainer.scrollTop - this.lastScroll.top;\r\n            if (deltaX || deltaY) {\r\n                this.handleScroll(deltaX, deltaY);\r\n            }\r\n            this.lastScroll.top = this.scrollContainer.scrollTop;\r\n            this.lastScroll.left = this.scrollContainer.scrollLeft;\r\n        }));\r\n        this.dragRef.moved\r\n            .pipe(debounceTime(10), takeUntil(this.stopDragging$))\r\n            .subscribe((/**\r\n         * @param {?} e\r\n         * @return {?}\r\n         */\r\n        e => {\r\n            this.autoScroll.onMove(e.pointerPosition);\r\n        }));\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    ended() {\r\n        this.destroyAutoScroll();\r\n        this.stopDragging$.next();\r\n        this.dragDebugService.reset();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    entered() {\r\n        this.dragFixContainer();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    exited() {\r\n        this.dragFixContainer();\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?} x\r\n     * @param {?} y\r\n     * @return {?}\r\n     */\r\n    handleScroll(x, y) {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        // adjust containers\r\n        this.adjustContainers();\r\n        // adjust items\r\n        this.adjustItems(x, y);\r\n        // ToDo: better condition for changed items\r\n        if (dropListRef._draggables.length > dropListRef._itemPositions.length) {\r\n            this.syncItems();\r\n        }\r\n        this.addDebugInfo();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    destroyAutoScroll() {\r\n        if (this.autoScroll) {\r\n            this.autoScroll.destroy();\r\n            this.autoScroll = null;\r\n        }\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    getDropListRef() {\r\n        return this.dragRef['_dropContainer'];\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    addDebugInfo() {\r\n        if (!this.dragDebugService.enabled) {\r\n            return;\r\n        }\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        /** @type {?} */\r\n        const draws = [\r\n            ...dropListRef._itemPositions.map((/**\r\n             * @param {?} it\r\n             * @return {?}\r\n             */\r\n            it => ({\r\n                clientRect: it.clientRect,\r\n                color: 'blue',\r\n                id: it.drag.data.data.name\r\n            }))),\r\n            ...dropListRef._siblings.map((/**\r\n             * @param {?} it\r\n             * @return {?}\r\n             */\r\n            it => ({\r\n                clientRect: it._clientRect,\r\n                color: 'green',\r\n                id: ''\r\n            }))),\r\n            {\r\n                clientRect: dropListRef._clientRect,\r\n                color: '#2FD1BB',\r\n                id: ''\r\n            }\r\n        ];\r\n        this.dragDebugService.log(draws.filter((/**\r\n         * @param {?} d\r\n         * @return {?}\r\n         */\r\n        d => d.clientRect)));\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    dragFixContainer() {\r\n        // https://github.com/angular/material2/issues/15227\r\n        setTimeout((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            /** @type {?} */\r\n            const dropListRef = this.getDropListRef();\r\n            dropListRef._cacheOwnPosition();\r\n            this.addDebugInfo();\r\n        }));\r\n        // fix for issue when classes is not resetted\r\n        this.changeDetectorRef.markForCheck();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    syncSiblings() {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        this.log('syncSiblings before', dropListRef._siblings.length);\r\n        dropListRef.beforeStarted.next();\r\n        this.log('syncSiblings after', dropListRef._siblings.length);\r\n        this.adjustContainers();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    syncItems() {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        /** @type {?} */\r\n        const oldPositions = dropListRef._itemPositions;\r\n        dropListRef._activeDraggables = dropListRef._draggables.slice();\r\n        dropListRef._cacheItemPositions();\r\n        /** @type {?} */\r\n        const newPositions = dropListRef._itemPositions;\r\n        dropListRef._itemPositions = [...oldPositions];\r\n        newPositions.forEach((/**\r\n         * @param {?} p\r\n         * @return {?}\r\n         */\r\n        p => {\r\n            if (!oldPositions.find((/**\r\n             * @param {?} p1\r\n             * @return {?}\r\n             */\r\n            p1 => p.drag === p1.drag))) {\r\n                dropListRef._itemPositions.push(p);\r\n            }\r\n        }));\r\n        dropListRef._activeDraggables.push(this.dragRef);\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    adjustContainers() {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        dropListRef._cacheOwnPosition();\r\n        dropListRef._siblings.forEach((/**\r\n         * @param {?} sibling\r\n         * @return {?}\r\n         */\r\n        sibling => {\r\n            sibling._cacheOwnPosition();\r\n        }));\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?} deltaX\r\n     * @param {?} deltaY\r\n     * @return {?}\r\n     */\r\n    adjustItems(deltaX, deltaY) {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        dropListRef._itemPositions.forEach((/**\r\n         * @param {?} it\r\n         * @return {?}\r\n         */\r\n        it => {\r\n            it.originalRect = it.originalRect || it.clientRect;\r\n            it.clientRect = Object.assign({}, it.clientRect, { left: it.clientRect.left - deltaX, right: it.clientRect.right - deltaX, top: it.clientRect.top - deltaY, bottom: it.clientRect.bottom - deltaY });\r\n        }));\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?=} message\r\n     * @param {...?} optionalParams\r\n     * @return {?}\r\n     */\r\n    log(message, ...optionalParams) {\r\n        if (this.dragDebugService.enabled) {\r\n            console.log(message, optionalParams);\r\n        }\r\n    }\r\n}\nDragScrollDirective.fac = function DragScrollDirective_Factory(t) { return new (t || DragScrollDirective)(ngcc0.directiveInject(ngcc1.CdkDrag), ngcc0.directiveInject(DragDebugService), ngcc0.directiveInject(ngcc0.NgZone), ngcc0.directiveInject(ngcc0.ChangeDetectorRef)); };\nDragScrollDirective.dir = /*@__PURE__*/ ngcc0.defineDirective({ type: DragScrollDirective, selectors: [[\"\", \"vsDragScroll\", \"\"]], inputs: { dragConnectedIds: [\"vsDragScrollConnectedTo\", \"dragConnectedIds\"], scrollContainer: [\"vsDragScrollContainer\", \"scrollContainer\"] }, exportAs: [\"vsDragScroll\"], features: [ngcc0.NgOnChangesFeature] });\r\n/** @nocollapse */\r\nDragScrollDirective.ctorParameters = () => [\r\n    { type: CdkDrag },\r\n    { type: DragDebugService },\r\n    { type: NgZone },\r\n    { type: ChangeDetectorRef }\r\n];\r\nDragScrollDirective.propDecorators = {\r\n    dragConnectedIds: [{ type: Input, args: ['vsDragScrollConnectedTo',] }],\r\n    scrollContainer: [{ type: Input, args: ['vsDragScrollContainer',] }]\r\n};\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ngcc0.setClassMetadata(DragScrollDirective, [{\n        type: Directive,\n        args: [{\n                selector: '[vsDragScroll]',\n                exportAs: 'vsDragScroll'\n            }]\n    }], function () { return [{ type: ngcc1.CdkDrag }, { type: DragDebugService }, { type: ngcc0.NgZone }, { type: ngcc0.ChangeDetectorRef }]; }, { dragConnectedIds: [{\n            type: Input,\n            args: ['vsDragScrollConnectedTo']\n        }], scrollContainer: [{\n            type: Input,\n            args: ['vsDragScrollContainer']\n        }] }); })();\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass DragScrollModule {\r\n}\nDragScrollModule.fac = function DragScrollModule_Factory(t) { return new (t || DragScrollModule)(); };\nDragScrollModule.mod = /*@__PURE__*/ ngcc0.defineNgModule({ type: DragScrollModule });\nDragScrollModule.inj = /*@__PURE__*/ ngcc0.defineInjector({ imports: [[DragDropModule]] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ngcc0.setClassMetadata(DragScrollModule, [{\n        type: NgModule,\n        args: [{\n                imports: [DragDropModule],\n                declarations: [DragScrollDirective],\n                exports: [DragScrollDirective]\n            }]\n    }], null, null); })();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ngcc0.setNgModuleScope(DragScrollModule, { declarations: function () { return [DragScrollDirective]; }, imports: function () { return [DragDropModule]; }, exports: function () { return [DragScrollDirective]; } }); })();\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\nexport { AutoScroll, DragDebugService, DragScrollDirective, DragScrollModule };\n\n","<div class=\"op-version-board-header\"\n      data-qa-selector=\"op-version-board-header\"\n     [ngClass]=\"{ '-closed': version.isClosed(), '-locked': version.isLocked() }\"\n     *ngIf=\"version\">\n  <h2 class=\"editable-toolbar-title--fixed\">\n    <small [textContent]=\"text.version\"></small>\n    <br/>\n    <a [href]=\"pathHelper.versionShowPath(version.id)\"\n       [textContent]=\"version.name\"\n       target=\"_blank\">\n    </a>\n  </h2>\n\n  <span class=\"op-version-board-header--info-row -italic -small-font\"> {{version.endDate}}  </span>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\nimport { Component, Input } from '@angular/core';\nimport { VersionResource } from 'core-app/features/hal/resources/version-resource';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\n\n@Component({\n  templateUrl: './version-board-header.html',\n  styleUrls: ['./version-board-header.sass'],\n  host: { class: 'title-container -small' },\n})\nexport class VersionBoardHeaderComponent {\n  @Input('resource') public version:VersionResource;\n\n  constructor(readonly I18n:I18nService,\n    readonly pathHelper:PathHelperService) {\n  }\n\n  public text = {\n    isLocked: this.I18n.t('js.boards.version.is_locked'),\n    isClosed: this.I18n.t('js.boards.version.is_closed'),\n    version: this.I18n.t('js.work_packages.properties.version'),\n  };\n}\n","import { Component, Inject, Injector } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { TabComponent } from 'core-app/features/work-packages/components/wp-table/configuration-modal/tab-portal-outlet';\nimport { OpModalLocalsMap } from 'core-app/shared/components/modal/modal.types';\nimport { OpModalLocalsToken } from 'core-app/shared/components/modal/modal.service';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { CardHighlightingMode } from 'core-app/features/work-packages/components/wp-fast-table/builders/highlighting/highlighting-mode.const';\n\n@Component({\n  templateUrl: './highlighting-tab.component.html',\n})\nexport class BoardHighlightingTabComponent implements TabComponent {\n  // Highlighting mode\n  public highlightingMode:CardHighlightingMode = 'none';\n\n  public entireCardMode = false;\n\n  public lastEntireCardAttribute:CardHighlightingMode = 'type';\n\n  // Current board resource\n  public board:Board;\n\n  public text = {\n    highlighting_mode: {\n      description: this.I18n.t('js.work_packages.table_configuration.highlighting_mode.description'),\n      none: this.I18n.t('js.work_packages.table_configuration.highlighting_mode.none'),\n      type: this.I18n.t('js.work_packages.properties.type'),\n      priority: this.I18n.t('js.work_packages.table_configuration.highlighting_mode.priority'),\n      entire_card_by: this.I18n.t('js.card.highlighting.entire_card_by'),\n    },\n  };\n\n  constructor(readonly injector:Injector,\n    @Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n    readonly I18n:I18nService) {\n  }\n\n  public onSave() {\n    this.updateMode(this.highlightingMode);\n    this.board.highlightingMode = this.highlightingMode;\n  }\n\n  ngOnInit() {\n    this.board = this.locals.board;\n    this.highlightingMode = this.board.highlightingMode;\n    this.updateMode(this.highlightingMode);\n  }\n\n  public updateMode(mode:CardHighlightingMode) {\n    if (mode === 'inline') {\n      this.highlightingMode = this.lastEntireCardAttribute;\n    } else {\n      this.highlightingMode = mode;\n    }\n\n    if (['priority', 'type'].indexOf(this.highlightingMode) !== -1) {\n      this.lastEntireCardAttribute = this.highlightingMode;\n      this.entireCardMode = true;\n    } else {\n      this.entireCardMode = false;\n    }\n  }\n}\n","<div>\n  <form>\n    <p [textContent]=\"text.highlighting_mode.description\"></p>\n    \n    <div class=\"form--field -full-width\">\n      <div class=\"form--field-container\">\n        <label class=\"option-label\">\n          <input type=\"radio\"\n                 [(ngModel)]=\"entireCardMode\"\n                 (change)=\"updateMode('inline')\"\n                 [value]=\"true\"\n                 name=\"entire_card_switch\">\n          <span [textContent]=\"text.highlighting_mode.entire_card_by\"></span>\n          &ngsp;\n          <select (change)=\"updateMode($event.target.value)\"\n                  id=\"selected_attribute\"\n                  name=\"selected_attribute\"\n                  class=\"form--select form--inline-select\">\n            <option [textContent]=\"text.highlighting_mode.type\"\n                    [selected]=\"lastEntireCardAttribute === 'type'\"\n                    value=\"type\"></option>\n            <option [textContent]=\"text.highlighting_mode.priority\"\n                    [selected]=\"lastEntireCardAttribute === 'priority'\"\n                    value=\"priority\"></option>\n          </select>\n        </label>\n      </div>\n    </div>\n    <div class=\"form--field -full-width\">\n      <div class=\"form--field-container\">\n        <label class=\"option-label\">\n          <input type=\"radio\"\n                 [(ngModel)]=\"highlightingMode\"\n                 (change)=\"updateMode($event.target.value)\"\n                 value=\"none\"\n                 name=\"highlighting_mode_switch\">\n          <span [textContent]=\"text.highlighting_mode.none\"></span>\n        </label>\n      </div>\n    </div>\n\n  </form>\n</div>\n\n","import { Injectable } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { TabInterface } from 'core-app/features/work-packages/components/wp-table/configuration-modal/tab-portal-outlet';\nimport { BoardHighlightingTabComponent } from 'core-app/features/boards/board/configuration-modal/tabs/highlighting-tab.component';\n\n@Injectable()\nexport class BoardConfigurationService {\n  protected _tabs:TabInterface[] = [\n    {\n      id: 'highlighting',\n      name: this.I18n.t('js.work_packages.table_configuration.highlighting'),\n      componentClass: BoardHighlightingTabComponent,\n    },\n  ];\n\n  constructor(readonly I18n:I18nService) {\n  }\n\n  public get tabs() {\n    return this._tabs;\n  }\n}\n","import { Board } from 'core-app/features/boards/board/board';\nimport { ComponentType } from '@angular/cdk/portal';\nimport { OpContextMenuItem } from 'core-app/shared/components/op-context-menu/op-context-menu.types';\nimport { DisabledButtonPlaceholder } from 'core-app/features/boards/board/board-list/board-list.component';\nimport { CreateAutocompleterComponent } from 'core-app/shared/components/autocompleter/create-autocompleter/create-autocompleter.component';\nimport { BoardListsService } from 'core-app/features/boards/board/board-list/board-lists.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { Injectable, Injector } from '@angular/core';\nimport { map } from 'rxjs/operators';\nimport { IFieldSchema } from 'core-app/shared/components/fields/field.base';\nimport { WorkPackageChangeset } from 'core-app/features/work-packages/components/wp-edit/work-package-changeset';\nimport { WorkPackageFilterValues } from 'core-app/features/work-packages/components/wp-edit-form/work-package-filter-values';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { SchemaCacheService } from 'core-app/core/schemas/schema-cache.service';\nimport { Observable } from 'rxjs';\nimport { FilterOperator } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { QueryFilterInstanceResource } from 'core-app/features/hal/resources/query-filter-instance-resource';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { HalResourceService } from 'core-app/features/hal/services/hal-resource.service';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport idFromLink from 'core-app/features/hal/helpers/id-from-link';\n\n@Injectable()\nexport abstract class BoardActionService {\n  constructor(readonly injector:Injector,\n    protected boardListsService:BoardListsService,\n    protected I18n:I18nService,\n    protected halResourceService:HalResourceService,\n    protected pathHelper:PathHelperService,\n    protected currentProject:CurrentProjectService,\n    protected apiV3Service:ApiV3Service,\n    protected schemaCache:SchemaCacheService) {\n  }\n\n  /**\n   * Get the attribute name\n   */\n  localizedName:string;\n\n  /**\n   * The action filter name\n   */\n  filterName:string;\n\n  /**\n   * The action resource name for the autocompleter\n   */\n  resourceName:string;\n\n  /**\n   * The icon used in tile\n   */\n  icon:string;\n\n  /**\n   * The description used in tile\n   */\n  description:string;\n\n  /**\n   * The description used in tile\n   */\n  image:string;\n\n  /**\n   * Label used to describe the values in the modal\n   */\n  label:string;\n\n  /**\n   * The text used in tile header\n   */\n  text:string;\n\n  /**\n   * Returns the current filter instance\n   * @param query\n   */\n  getActionFilter(query:QueryResource, getHref = false):QueryFilterInstanceResource|undefined {\n    return query.filters.find((filter) => filter.id === this.filterName);\n  }\n\n  /**\n   * Returns the current filter value ID if any\n   * @param query\n   * @returns The id of the resource\n   */\n  getActionValueId(query:QueryResource, getHref = false):string|undefined {\n    const filter = this.getActionFilter(query);\n    if (!filter) {\n      return;\n    }\n\n    const value = filter.values[0];\n\n    if (value instanceof HalResource) {\n      return getHref ? value.href! : value.id!;\n    }\n\n    return value;\n  }\n\n  /**\n   * Returns the current filter value if any\n   * @param query\n   * @returns The loaded action resource\n   */\n  getLoadedActionValue(query:QueryResource):Promise<HalResource|undefined> {\n    const id = this.getActionValueId(query);\n\n    if (!id) {\n      return Promise.resolve(undefined);\n    }\n\n    return this.require(id);\n  }\n\n  /**\n   * Add initial queries to a new board\n   *\n   * @param newBoard\n   */\n  addInitialColumnsForAction(newBoard:Board):Promise<Board> {\n    return Promise.resolve(newBoard);\n  }\n\n  /**\n   * Add a single action query\n   */\n  addColumnWithActionAttribute(board:Board, value:HalResource):Promise<Board> {\n    const params:any = {\n      name: value.name,\n    };\n\n    const filter = {\n      [this.filterName]: {\n        operator: '=' as FilterOperator,\n        values: [idFromLink(value.href)],\n      },\n    };\n\n    return this.boardListsService.addQuery(board, params, [filter]);\n  }\n\n  /**\n   * Get available values from the active queries\n   *\n   * @param board The board we're looking at\n   * @param active The active set of values (resources or plain values)\n   * @param matching values matching the given name\n   */\n  loadAvailable(active:Set<string>, matching:string):Observable<HalResource[]> {\n    return this\n      .loadValues(matching)\n      .pipe(\n        map((items) => items.filter((item) => !active.has(item.id!))),\n      );\n  }\n\n  /**\n   * Get action specific items that shall be shown in the list menu\n   * @returns {any[]}\n   */\n  getAdditionalListMenuItems(query:QueryResource):Promise<OpContextMenuItem[]> {\n    return Promise.resolve([]);\n  }\n\n  /**\n   * Get the specific component for the autocompleter (e.g versionAutocompleter)\n   * @returns {Component}\n   */\n  autocompleterComponent():ComponentType<unknown> {\n    return CreateAutocompleterComponent;\n  }\n\n  /**\n   * Get the specific header component for the board list, or undefined if none\n   * @returns {Component}\n   */\n  headerComponent():ComponentType<unknown>|undefined {\n    return undefined;\n  }\n\n  /**\n   * Get icon and text to show on the add button when it is disabled\n   * @returns {the icon class or nothing}\n   */\n  disabledAddButtonPlaceholder(resource?:HalResource):DisabledButtonPlaceholder|undefined {\n    return undefined;\n  }\n\n  /**\n   * Determines the specific warning to be shown, when there are no options to add as a list\n   * @returns {the text or nothing}\n   */\n  warningTextWhenNoOptionsAvailable(hasMember?:boolean):Promise<string|undefined> {\n    return Promise.resolve(undefined);\n  }\n\n  /**\n   * Determine whether we can drag items into a given query for the\n   * selected action value\n   *\n   * @param query\n   * @param value\n   */\n  dragIntoAllowed(query:QueryResource, value:HalResource|undefined):boolean {\n    return true;\n  }\n\n  /**\n   * Determine whether we can create new items for this action attribute\n   */\n  canAddToQuery(query:QueryResource):Promise<boolean> {\n    return Promise.resolve(true);\n  }\n\n  /**\n   * Determine whether the given work package can be moved\n   */\n  canMove(workPackage:WorkPackageResource):boolean {\n    const schema = this.schemaCache.of(workPackage);\n    const fieldSchema = schema[this.filterName] as IFieldSchema;\n    return fieldSchema?.writable;\n  }\n\n  /**\n   * Assign the work package to the action attribute\n   */\n  assignToWorkPackage(changeset:WorkPackageChangeset, query:QueryResource) {\n    // Ensure attribute remains writable in the form\n    if (!changeset.isWritable(this.filterName)) {\n      throw new Error(this.I18n.t(\n        'js.boards.error_attribute_not_writable',\n        { attribute: changeset.humanName(this.filterName) },\n      ));\n    }\n\n    new WorkPackageFilterValues(this.injector, query.filters)\n      .applyDefaultsFromFilters(changeset);\n  }\n\n  /**\n   * Require the given resource to be loaded.\n   *\n   * @param id\n   * @protected\n   */\n  protected abstract require(id:string):Promise<HalResource>;\n\n  /**\n   * Load values optionally matching the given name\n   *\n   * @param matching\n   * @protected\n   */\n  protected abstract loadValues(matching?:string):Observable<HalResource[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { BoardActionService } from 'core-app/features/boards/board/board-actions/board-action.service';\nimport { input } from 'reactivestates';\nimport { Observable } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\n\n@Injectable()\nexport abstract class CachedBoardActionService extends BoardActionService {\n  protected cache = input<HalResource[]>();\n\n  protected loadValues(matching?:string):Observable<HalResource[]> {\n    this\n      .cache\n      .putFromPromiseIfPristine(() => this.loadUncached());\n\n    return this\n      .cache\n      .values$()\n      .pipe(\n        map((results) => {\n          if (matching) {\n            return results.filter((resource) => new RegExp(matching, 'i').test(resource.name));\n          }\n          return results;\n        }),\n        take(1),\n      );\n  }\n\n  addColumnWithActionAttribute(board:Board, value:HalResource):Promise<Board> {\n    if (this.cache.value && !this.cache.value.find((item) => item.id === value.id)) {\n      // Add the new value to the cache if it was not there before\n      const newValue = [...this.cache.value, value];\n      this.cache.putValue(newValue);\n    }\n\n    return super.addColumnWithActionAttribute(board, value);\n  }\n\n  protected require(id:string):Promise<HalResource> {\n    this\n      .cache\n      .putFromPromiseIfPristine(() => this.loadUncached());\n\n    return this\n      .cache\n      .values$()\n      .pipe(\n        take(1),\n      )\n      .toPromise()\n      .then((results) => results.find((resource) => resource.id === id)!);\n  }\n\n  protected abstract loadUncached():Promise<HalResource[]>;\n}\n","<div class=\"op-status-board-header\" *ngIf=\"status\">\n  <h2 class=\"editable-toolbar-title--fixed\">\n    <small [textContent]=\"text.status\"></small>\n    <br/>\n    {{ status.name }}\n  </h2>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\nimport { Component, Input } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { StatusResource } from 'core-app/features/hal/resources/status-resource';\n\n@Component({\n  templateUrl: './status-board-header.html',\n  styleUrls: ['./status-board-header.sass'],\n  host: { class: 'title-container -small' },\n})\nexport class StatusBoardHeaderComponent {\n  @Input('resource') public status:StatusResource;\n\n  text = {\n    status: this.I18n.t('js.work_packages.properties.status'),\n  };\n\n  constructor(readonly I18n:I18nService) {\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { StatusResource } from 'core-app/features/hal/resources/status-resource';\nimport { CachedBoardActionService } from 'core-app/features/boards/board/board-actions/cached-board-action.service';\nimport { StatusBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/status/status-board-header.component';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\n\n@Injectable()\nexport class BoardStatusActionService extends CachedBoardActionService {\n  filterName = 'status';\n\n  resourceName = 'status';\n\n  text = this.I18n.t('js.boards.board_type.board_type_title.status');\n\n  description = this.I18n.t('js.boards.board_type.action_text_status');\n\n  label = this.I18n.t('js.boards.add_list_modal.labels.status');\n\n  icon = 'icon-workflow';\n\n  image = imagePath('board_creation_modal/status.svg');\n\n  localizedName = this.I18n.t('js.work_packages.properties.status');\n\n  headerComponent() {\n    return StatusBoardHeaderComponent;\n  }\n\n  public addInitialColumnsForAction(board:Board):Promise<Board> {\n    return this\n      .loadValues()\n      .toPromise()\n      .then((results) => Promise.all<unknown>(\n        results.map((status:StatusResource) => {\n          if (status.isDefault) {\n            return this.addColumnWithActionAttribute(board, status);\n          }\n\n          return Promise.resolve(board);\n        }),\n      )\n        .then(() => board));\n  }\n\n  public warningTextWhenNoOptionsAvailable():Promise<string> {\n    return Promise.resolve(this.I18n.t('js.boards.add_list_modal.warning.status'));\n  }\n\n  protected loadUncached():Promise<StatusResource[]> {\n    return this\n      .apiV3Service\n      .statuses\n      .get()\n      .toPromise()\n      .then((collection) => collection.elements);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { VersionResource } from 'core-app/features/hal/resources/version-resource';\nimport { OpContextMenuItem } from 'core-app/shared/components/op-context-menu/op-context-menu.types';\nimport { isClickedWithModifier } from 'core-app/shared/helpers/link-handling/link-handling';\nimport { StateService } from '@uirouter/core';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { VersionBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/version/version-board-header.component';\nimport { FormResource } from 'core-app/features/hal/resources/form-resource';\nimport { InjectField } from 'core-app/shared/helpers/angular/inject-field.decorator';\nimport { CachedBoardActionService } from 'core-app/features/boards/board/board-actions/cached-board-action.service';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\nimport { VersionAutocompleterComponent } from 'core-app/shared/components/autocompleter/version-autocompleter/version-autocompleter.component';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\n\n@Injectable()\nexport class BoardVersionActionService extends CachedBoardActionService {\n  @InjectField() state:StateService;\n\n  @InjectField() halNotification:HalResourceNotificationService;\n\n  filterName = 'version';\n\n  resourceName = 'version';\n\n  text = this.I18n.t('js.boards.board_type.board_type_title.version');\n\n  description = this.I18n.t('js.boards.board_type.action_text_version');\n\n  label = this.I18n.t('js.boards.add_list_modal.labels.version');\n\n  icon = 'icon-getting-started';\n\n  image = imagePath('board_creation_modal/version.svg');\n\n  private writable$:Promise<boolean>;\n\n  localizedName = this.I18n.t('js.work_packages.properties.version');\n\n  public canAddToQuery(query:QueryResource):Promise<boolean> {\n    const formLink = _.get(query, 'results.createWorkPackage.href', null);\n\n    if (!formLink) {\n      return Promise.resolve(false);\n    }\n\n    if (!this.writable$) {\n      this.writable$ = query.results.createWorkPackage()\n        .then((form:FormResource) => form.schema.version.writable);\n    }\n\n    return this.writable$;\n  }\n\n  public addInitialColumnsForAction(board:Board):Promise<Board> {\n    return this\n      .loadValues()\n      .toPromise()\n      .then((results) => Promise.all<unknown>(\n        results.map((version:VersionResource) => {\n          const definingName = _.get(version, 'definingProject.name', null);\n          if (version.isOpen() && definingName && definingName === this.currentProject.name) {\n            return this.addColumnWithActionAttribute(board, version);\n          }\n\n          return Promise.resolve(board);\n        }),\n      )\n        .then(() => board));\n  }\n\n  /**\n   * Adds an entry to the list menu to edit the version if allowed\n   * @param {QueryResource} query The active query\n   * @returns {Promise<any>}\n   */\n  public getAdditionalListMenuItems(query:QueryResource):Promise<OpContextMenuItem[]> {\n    return this\n      .getLoadedActionValue(query)\n      .then((version:VersionResource) => {\n        if (version) {\n          return this.buildItemsForVersion(version);\n        }\n        return [];\n      });\n  }\n\n  public autocompleterComponent() {\n    return VersionAutocompleterComponent;\n  }\n\n  public headerComponent() {\n    return VersionBoardHeaderComponent;\n  }\n\n  public disabledAddButtonPlaceholder(version:VersionResource) {\n    if (version.isLocked()) {\n      return { icon: 'locked', text: this.I18n.t('js.boards.version.locked') };\n    } if (version.isClosed()) {\n      return { icon: 'not-supported', text: this.I18n.t('js.boards.version.closed') };\n    }\n    return undefined;\n  }\n\n  public dragIntoAllowed(query:QueryResource, value:HalResource|undefined) {\n    return value instanceof VersionResource && value.isOpen();\n  }\n\n  protected loadUncached():Promise<HalResource[]> {\n    if (this.currentProject.id === null) {\n      return Promise.resolve([]);\n    }\n\n    return this\n      .apiV3Service\n      .projects\n      .id(this.currentProject.id)\n      .versions\n      .get()\n      .toPromise()\n      .then((collection) => collection.elements);\n  }\n\n  private patchVersionStatus(version:VersionResource, newStatus:'open'|'closed'|'locked') {\n    this.apiV3Service\n      .versions\n      .id(version)\n      .patch({ status: newStatus })\n      .subscribe(\n        (version) => {\n          this.state.go('.', {}, { reload: true });\n        },\n        (error) => this.halNotification.handleRawError(error),\n      );\n  }\n\n  private buildItemsForVersion(version:VersionResource):OpContextMenuItem[] {\n    const id = version.id!;\n    return [\n      {\n        // Lock version\n        hidden: !version.isOpen() || (version.isLocked() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.lock_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'locked');\n          return true;\n        },\n      },\n      {\n        // Unlock version\n        hidden: !version.isLocked() || (version.isOpen() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.unlock_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'open');\n          return true;\n        },\n      },\n      {\n        // Close version\n        hidden: version.isClosed() || (!version.isClosed() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.close_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'closed');\n          return true;\n        },\n      },\n      {\n        // Open version\n        hidden: !version.isClosed() || (version.isClosed() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.open_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'open');\n          return true;\n        },\n      },\n      {\n        // Show link\n        linkText: this.I18n.t('js.boards.version.show_version'),\n        href: this.pathHelper.versionShowPath(id),\n        onClick: (evt:JQuery.TriggeredEvent) => {\n          if (!isClickedWithModifier(evt)) {\n            window.open(this.pathHelper.versionShowPath(id), '_blank');\n            return true;\n          }\n\n          return false;\n        },\n      },\n      {\n        // Edit link\n        hidden: !version.$links.update,\n        linkText: this.I18n.t('js.boards.version.edit_version'),\n        href: this.pathHelper.versionEditPath(id),\n        onClick: (evt:JQuery.TriggeredEvent) => {\n          if (!isClickedWithModifier(evt)) {\n            window.open(this.pathHelper.versionEditPath(id), '_blank');\n            return true;\n          }\n\n          return false;\n        },\n      },\n    ];\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { interval } from 'rxjs';\nimport { filter, startWith, switchMap } from 'rxjs/operators';\nimport { ActiveWindowService } from 'core-app/core/active-window/active-window.service';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\n\nconst POLLING_INTERVAL = 2000;\n\n@Injectable()\nexport class QueryUpdatedService {\n  constructor(readonly activeWindow:ActiveWindowService,\n    readonly apiV3Service:ApiV3Service) {\n  }\n\n  public monitor(ids:string[]) {\n    let time = new Date();\n\n    return interval(POLLING_INTERVAL)\n      .pipe(\n        startWith(0),\n        filter(() => ids.length > 0),\n        filter(() => this.activeWindow.isActive),\n        switchMap(() => {\n          const result = this.queryForUpdates(ids, time);\n\n          time = new Date();\n\n          return result;\n        }),\n        filter((collection) => collection.count > 0),\n      );\n  }\n\n  private queryForUpdates(ids:string[], updatedAfter:Date) {\n    return this\n      .apiV3Service\n      .queries\n      .list({\n        filters: [['id', '=', ids],\n          ['updatedAt', '<>d', [updatedAfter.toISOString()]]],\n      });\n  }\n}\n","<div class=\"op-assignee-board-header\" *ngIf=\"user\">\n  <op-principal\n    *ngIf=\"user.id\"\n    [principal]=\"user\"\n    [hideName]=\"true\"\n    size=\"mini\"\n  ></op-principal>\n  <h2 class=\"editable-toolbar-title--fixed\">\n    <small [textContent]=\"text.assignee\"></small>\n    <br/>\n    <a *ngIf=\"user.id\"\n       [href]=\"pathHelper.userPath(user.id)\"\n       [textContent]=\"user.name\"\n       target=\"_blank\">\n    </a>\n    <span *ngIf=\"!user.id\"\n      [textContent]=\"user.name\">\n    </span>\n  </h2>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\nimport { Component, Input } from '@angular/core';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { UserResource } from 'core-app/features/hal/resources/user-resource';\n\n@Component({\n  templateUrl: './assignee-board-header.html',\n  styleUrls: ['./assignee-board-header.sass'],\n  host: { class: 'title-container -small' },\n})\nexport class AssigneeBoardHeaderComponent {\n  @Input('resource') public user:UserResource;\n\n  text = {\n    assignee: this.I18n.t('js.work_packages.properties.assignee'),\n  };\n\n  constructor(readonly pathHelper:PathHelperService,\n    readonly I18n:I18nService) {\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AssigneeBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/assignee/assignee-board-header.component';\nimport { CachedBoardActionService } from 'core-app/features/boards/board/board-actions/cached-board-action.service';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\nimport { ApiV3Filter } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { CollectionResource } from 'core-app/features/hal/resources/collection-resource';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { UserResource } from 'core-app/features/hal/resources/user-resource';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport idFromLink from 'core-app/features/hal/helpers/id-from-link';\nimport { ProjectResource } from 'core-app/features/hal/resources/project-resource';\n\n@Injectable()\nexport class BoardAssigneeActionService extends CachedBoardActionService {\n  filterName = 'assignee';\n\n  resourceName = 'assignee';\n\n  text = this.I18n.t('js.boards.board_type.board_type_title.assignee');\n\n  description = this.I18n.t('js.boards.board_type.action_text_assignee');\n\n  label = this.I18n.t('js.boards.add_list_modal.labels.assignee');\n\n  icon = 'icon-user';\n\n  image = imagePath('board_creation_modal/assignees.svg');\n\n  readonly unassignedUser:any = {\n    id: null,\n    href: null,\n    name: this.I18n.t('js.filter.noneElement'),\n  };\n\n  /**\n   * Add a single action query\n   */\n  addColumnWithActionAttribute(board:Board, value:HalResource):Promise<Board> {\n    const params:any = {\n      name: value.name,\n    };\n\n    let filter:ApiV3Filter;\n\n    if (value.id === null) {\n      filter = {\n        assignee: {\n          operator: '!*',\n          values: [],\n        },\n      };\n    } else {\n      filter = {\n        assignee: {\n          operator: '=',\n          values: [idFromLink(value.href)],\n        },\n      };\n    }\n\n    return this.boardListsService.addQuery(board, params, [filter]);\n  }\n\n  /**\n   * Returns the current filter value if any\n   * @param query\n   * @returns The loaded action resource\n   */\n  getLoadedActionValue(query:QueryResource):Promise<HalResource|undefined> {\n    const filter = this.getActionFilter(query);\n\n    // Return the special unassigned user\n    if (filter && filter.operator.id === '!*') {\n      return Promise.resolve(this.unassignedUser);\n    }\n\n    return super.getLoadedActionValue(query);\n  }\n\n  localizedName = this.I18n.t('js.work_packages.properties.assignee');\n\n  public headerComponent() {\n    return AssigneeBoardHeaderComponent;\n  }\n\n  public warningTextWhenNoOptionsAvailable(hasMember?:boolean) {\n    let text = hasMember\n      ? this.I18n.t('js.boards.add_list_modal.warning.assignee')\n      : this.I18n.t('js.boards.add_list_modal.warning.no_member');\n\n    return this\n      .apiV3Service\n      .projects\n      .id(this.currentProject.id!)\n      .get()\n      .toPromise()\n      .then((project:ProjectResource) => {\n        if (project.memberships) {\n          text = text.concat(\n            this.I18n.t('js.boards.add_list_modal.warning.add_members', {\n              link: this.pathHelper.projectMembershipsPath(this.currentProject.identifier!),\n            }),\n          );\n        }\n\n        return text;\n      });\n  }\n\n  protected loadUncached():Promise<HalResource[]> {\n    return this\n      .apiV3Service\n      .projects\n      .id(this.currentProject.identifier!)\n      .available_assignees\n      .get()\n      .toPromise()\n      .then(\n        (collection:CollectionResource<UserResource>) => [this.unassignedUser].concat(collection.elements),\n      );\n  }\n}\n","<div class=\"op-subproject-board-header\" *ngIf=\"resource\">\n  <h2 class=\"editable-toolbar-title--fixed\">\n    <small [textContent]=\"text.project\"></small>\n    <br/>\n    <a [href]=\"pathHelper.projectPath(idFromLink(resource.href))\"\n       [textContent]=\"resource.name\"\n       target=\"_blank\">\n    </a>\n  </h2>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\nimport { Component, Input } from '@angular/core';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport idFromLink from 'core-app/features/hal/helpers/id-from-link';\n\n@Component({\n  templateUrl: './subproject-board-header.html',\n  styleUrls: ['./subproject-board-header.sass'],\n  host: { class: 'title-container -small' },\n})\nexport class SubprojectBoardHeaderComponent {\n  @Input() public resource:HalResource;\n\n  idFromLink = idFromLink;\n\n  text = {\n    project: this.I18n.t('js.label_project'),\n  };\n\n  constructor(readonly pathHelper:PathHelperService,\n    readonly I18n:I18nService) {\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserResource } from 'core-app/features/hal/resources/user-resource';\nimport { WorkPackageChangeset } from 'core-app/features/work-packages/components/wp-edit/work-package-changeset';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { SubprojectBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/subproject/subproject-board-header.component';\nimport { CachedBoardActionService } from 'core-app/features/boards/board/board-actions/cached-board-action.service';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\nimport { ApiV3FilterBuilder } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport { CollectionResource } from 'core-app/features/hal/resources/collection-resource';\n\n@Injectable()\nexport class BoardSubprojectActionService extends CachedBoardActionService {\n  filterName = 'onlySubproject';\n\n  resourceName = 'subproject';\n\n  text = this.I18n.t('js.boards.board_type.board_type_title.subproject');\n\n  description = this.I18n.t('js.boards.board_type.action_text_subprojects');\n\n  label = this.I18n.t('js.boards.add_list_modal.labels.subproject');\n\n  icon = 'icon-projects';\n\n  image = imagePath('board_creation_modal/subproject.svg');\n\n  localizedName = this.I18n.t('js.work_packages.properties.subproject');\n\n  headerComponent() {\n    return SubprojectBoardHeaderComponent;\n  }\n\n  canMove(workPackage:WorkPackageResource):boolean {\n    // We can only move the work package\n    // if the `move` (move between projects) is allowed.\n    return !!workPackage.move;\n  }\n\n  assignToWorkPackage(changeset:WorkPackageChangeset, query:QueryResource) {\n    const href = this.getActionValueId(query, true);\n    changeset.setValue('project', { href });\n  }\n\n  protected loadUncached():Promise<HalResource[]> {\n    const currentProjectId = this.currentProject.id!;\n    return this\n      .apiV3Service\n      .projects\n      .filtered(\n        new ApiV3FilterBuilder()\n          .add('ancestor', '=', [currentProjectId])\n          .add('active', '=', true),\n      )\n      .get()\n      .toPromise()\n      .then((collection:CollectionResource<UserResource>) => collection.elements);\n  }\n}\n","<div class=\"op-subtask-board-header\" *ngIf=\"resource\">\n  <h2 class=\"editable-toolbar-title--fixed\">\n    <small [textContent]=\"text.workPackage\"></small>\n    <br/>\n    <span class=\"op-subtask-board-header--work-package-type\"\n          [ngClass]=\"typeHighlightingClass\"\n          [textContent]=\"resource.type.name\">\n    </span>\n    <a [href]=\"pathHelper.workPackagePath(idFromLink(resource.href))\"\n       [textContent]=\"resource.subjectWithId()\"\n       target=\"_blank\">\n    </a>\n  </h2>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\nimport { Component, Input, OnInit } from '@angular/core';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { Highlighting } from 'core-app/features/work-packages/components/wp-fast-table/builders/highlighting/highlighting.functions';\nimport idFromLink from 'core-app/features/hal/helpers/id-from-link';\n\n@Component({\n  templateUrl: './subtasks-board-header.html',\n  styleUrls: ['./subtasks-board-header.sass'],\n  host: { class: 'title-container -small' },\n})\nexport class SubtasksBoardHeaderComponent implements OnInit {\n  @Input() public resource:WorkPackageResource;\n\n  idFromLink = idFromLink;\n\n  text = {\n    workPackage: this.I18n.t('js.label_work_package_parent'),\n  };\n\n  typeHighlightingClass:string;\n\n  constructor(readonly pathHelper:PathHelperService,\n    readonly I18n:I18nService) {\n  }\n\n  ngOnInit() {\n    this.typeHighlightingClass = Highlighting.inlineClass('type', this.resource.type.id!);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BoardActionService } from 'core-app/features/boards/board/board-actions/board-action.service';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { SubtasksBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/subtasks/subtasks-board-header.component';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { WorkPackageChangeset } from 'core-app/features/work-packages/components/wp-edit/work-package-changeset';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\nimport { ApiV3FilterBuilder } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\n\n@Injectable()\nexport class BoardSubtasksActionService extends BoardActionService {\n  filterName = 'parent';\n\n  resourceName = 'parent-child';\n\n  text = this.I18n.t('js.boards.board_type.board_type_title.subtasks');\n\n  description = this.I18n.t('js.boards.board_type.action_text_subtasks');\n\n  label = this.I18n.t('js.boards.add_list_modal.labels.subtasks');\n\n  icon = 'icon-hierarchy';\n\n  image = imagePath('board_creation_modal/parent-child.svg');\n\n  localizedName = this.I18n.t('js.boards.board_type.action_type.subtasks');\n\n  public headerComponent() {\n    return SubtasksBoardHeaderComponent;\n  }\n\n  public canMove(workPackage:WorkPackageResource):boolean {\n    return !!workPackage.changeParent;\n  }\n\n  assignToWorkPackage(changeset:WorkPackageChangeset, query:QueryResource) {\n    const parentId = this.getActionValueId(query)?.toString();\n\n    // Disable dragging a work package into its own column\n    if (parentId === changeset.id) {\n      throw new Error(this.I18n.t('js.boards.error_cannot_move_into_self'));\n    }\n\n    super.assignToWorkPackage(changeset, query);\n  }\n\n  protected loadValues(matching?:string):Observable<HalResource[]> {\n    const filters = new ApiV3FilterBuilder();\n    filters.add('is_milestone', '=', false);\n    filters.add('project', '=', [this.currentProject.id || '']);\n\n    if (matching) {\n      filters.add('subjectOrId', '**', [matching]);\n    }\n\n    return this\n      .apiV3Service\n      .work_packages\n      .filtered(filters, { pageSize: '-1' })\n      .get()\n      .pipe(\n        map((collection) => collection.elements),\n      );\n  }\n\n  protected require(id:string):Promise<HalResource> {\n    return this\n      .apiV3Service\n      .work_packages\n      .id(id)\n      .get()\n      .toPromise();\n  }\n}\n","import { Component, Injector } from '@angular/core';\nimport { BoardConfigurationService } from 'core-app/features/boards/board/configuration-modal/board-configuration.service';\nimport { BoardActionsRegistryService } from 'core-app/features/boards/board/board-actions/board-actions-registry.service';\nimport { BoardStatusActionService } from 'core-app/features/boards/board/board-actions/status/status-action.service';\nimport { BoardVersionActionService } from 'core-app/features/boards/board/board-actions/version/version-action.service';\nimport { QueryUpdatedService } from 'core-app/features/boards/board/query-updated/query-updated.service';\nimport { BoardAssigneeActionService } from 'core-app/features/boards/board/board-actions/assignee/assignee-action.service';\nimport { BoardSubprojectActionService } from 'core-app/features/boards/board/board-actions/subproject/subproject-action.service';\nimport { BoardSubtasksActionService } from 'core-app/features/boards/board/board-actions/subtasks/board-subtasks-action.service';\n\n@Component({\n  selector: 'boards-entry',\n  template: '<ui-view wp-isolated-query-space></ui-view>',\n  providers: [\n    BoardConfigurationService,\n    BoardStatusActionService,\n    BoardVersionActionService,\n    BoardAssigneeActionService,\n    BoardSubprojectActionService,\n    BoardSubtasksActionService,\n    QueryUpdatedService,\n  ],\n})\nexport class BoardsRootComponent {\n  constructor(readonly injector:Injector) {\n    // Register action services\n    const registry = injector.get(BoardActionsRegistryService);\n\n    registry.add('status', injector.get(BoardStatusActionService));\n    registry.add('assignee', injector.get(BoardAssigneeActionService));\n    registry.add('version', injector.get(BoardVersionActionService));\n    registry.add('subproject', injector.get(BoardSubprojectActionService));\n    registry.add('subtasks', injector.get(BoardSubtasksActionService));\n  }\n}\n","<div class=\"toolbar-container\">\n  <div class=\"toolbar\">\n    <div class=\"title-container\">\n      <h2 [textContent]=\"text.boards\"></h2>\n    </div>\n    <ul class=\"toolbar-items\">\n      <li *ngIf=\"canAdd\"\n          class=\"toolbar-item\">\n        <a class=\"button -alt-highlight\"\n           [title]=\"text.create_new_board\"\n           (click)=\"newBoard()\">\n          <op-icon icon-classes=\"button--icon icon-add\">\n          </op-icon>\n          <span class=\"button--text\"\n                [textContent]=\"text.board\">\n          </span>\n        </a>\n      </li>\n    </ul>\n  </div>\n</div>\n\n<div class=\"boards--listing-group loading-indicator--location\"\n     data-indicator-name=\"boards-module\">\n  <div *ngIf=\"(boards$ | async) as boards\"\n       class=\"generic-table--container\">\n    <div class=\"generic-table--results-container\">\n      <table class=\"generic-table\">\n        <colgroup>\n          <col opHighlightCol>\n          <col opHighlightCol>\n          <col opHighlightCol>\n          <col opHighlightCol>\n          <col>\n        </colgroup>\n        <thead>\n          <tr>\n            <th>\n              <div class=\"generic-table--sort-header-outer\">\n                <div class=\"generic-table--sort-header\">\n                 <span [textContent]=\"text.name\">\n                 </span>\n                </div>\n              </div>\n            </th>\n            <th>\n              <div class=\"generic-table--sort-header-outer\">\n                <div class=\"generic-table--sort-header\">\n                 <span [textContent]=\"text.type\">\n                 </span>\n                </div>\n              </div>\n            </th>\n            <th>\n              <div class=\"generic-table--sort-header-outer\">\n                <div class=\"generic-table--sort-header\">\n                 <span [textContent]=\"text.createdAt\">\n                 </span>\n                </div>\n              </div>\n            </th>\n            <th>\n              <div class=\"generic-table--empty-header\">\n              </div>\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n        <tr *ngIf=\"boards.length === 0\" id=\"empty-row-notification\">\n          <td colspan=\"4\">\n            <span>\n              <op-icon icon-classes=\"icon-info1 icon-context\"></op-icon>\n              <span>\n                <strong [textContent]=\"text.noResults\"></strong>\n              </span>\n            </span>\n          </td>\n        </tr>\n        <tr *ngFor=\"let board of boards\">\n          <td\n            class=\"name\"\n            data-qa-selector=\"boards-table-column--name\"\n          >\n           <a [textContent]=\"board.name\"\n              uiSref=\"boards.partitioned.show\"\n              [uiParams]=\"{ board_id: board.id }\">\n           </a>\n          </td>\n          <td>\n            <span *ngIf=\"board.isFree\" [textContent]=\"text.type_free\"></span>\n            <span *ngIf=\"board.isAction\" [textContent]=\"text.action_by_attribute(board.actionAttribute)\"></span>\n          </td>\n          <td>\n            <op-date-time [dateTimeValue]=\"board.createdAt\"></op-date-time>\n          </td>\n          <td class=\"buttons\">\n            <button class=\"spot-link\"\n                    type=\"button\"\n                    (click)=\"destroyBoard(board)\"\n                    [title]=\"text.delete\"\n                    >\n              <op-icon icon-classes=\"icon icon-delete\"></op-icon>\n            </button>\n          </td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>\n","import {\n  AfterViewInit,\n  Component,\n  Injector,\n  OnInit,\n} from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { ToastService } from 'core-app/shared/components/toaster/toast.service';\nimport { OpModalService } from 'core-app/shared/components/modal/modal.service';\nimport { NewBoardModalComponent } from 'core-app/features/boards/new-board-modal/new-board-modal.component';\nimport { LoadingIndicatorService } from 'core-app/core/loading-indicator/loading-indicator.service';\nimport { AuthorisationService } from 'core-app/core/model-auth/model-auth.service';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { componentDestroyed } from '@w11k/ngx-componentdestroyed';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { map } from 'rxjs/operators';\n\n@Component({\n  templateUrl: './boards-index-page.component.html',\n  styleUrls: ['./boards-index-page.component.sass'],\n})\nexport class BoardsIndexPageComponent extends UntilDestroyedMixin implements OnInit, AfterViewInit {\n  public text = {\n    name: this.I18n.t('js.modals.label_name'),\n    create: this.I18n.t('js.button_create'),\n    create_new_board: this.I18n.t('js.boards.create_new'),\n    board: this.I18n.t('js.label_board'),\n    boards: this.I18n.t('js.label_board_plural'),\n    type: this.I18n.t('js.boards.label_board_type'),\n    type_free: this.I18n.t('js.boards.board_type.free'),\n    action_by_attribute: (attr:string) => this.I18n.t('js.boards.board_type.action_by_attribute',\n      { attribute: this.I18n.t(`js.boards.board_type.action_type.${attr}`) }),\n    createdAt: this.I18n.t('js.label_created_on'),\n    delete: this.I18n.t('js.button_delete'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n    noResults: this.I18n.t('js.notice_no_results_to_display'),\n  };\n\n  public canAdd = false;\n\n  public boards$:Observable<Board[]> = this\n    .apiV3Service\n    .boards\n    .observeAll()\n    .pipe(\n      map((boards:Board[]) => boards.sort((a, b) => a.name.localeCompare(b.name))),\n    );\n\n  constructor(\n    private readonly boardService:BoardService,\n    private readonly apiV3Service:ApiV3Service,\n    private readonly I18n:I18nService,\n    private readonly toastService:ToastService,\n    private readonly opModalService:OpModalService,\n    private readonly loadingIndicatorService:LoadingIndicatorService,\n    private readonly authorisationService:AuthorisationService,\n    private readonly injector:Injector,\n  ) {\n    super();\n  }\n\n  ngOnInit():void {\n    this.authorisationService\n      .observeUntil(componentDestroyed(this))\n      .subscribe(() => {\n        this.canAdd = this.authorisationService.can('boards', 'create');\n      });\n  }\n\n  ngAfterViewInit():void {\n    const loadingIndicator = this.loadingIndicatorService.indicator('boards-module');\n    loadingIndicator.promise = this.boardService.loadAllBoards();\n  }\n\n  newBoard():void {\n    this.opModalService.show(NewBoardModalComponent, this.injector);\n  }\n\n  destroyBoard(board:Board):void {\n    if (!window.confirm(this.text.areYouSure)) {\n      return;\n    }\n\n    this.boardService\n      .delete(board)\n      .then(() => {\n        this.toastService.addSuccess(this.text.deleteSuccessful);\n      })\n      .catch((error) => this.toastService.addError(`Deletion failed: ${error}`));\n  }\n}\n","import { AfterViewInit, Component, Input } from '@angular/core';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { WorkPackageStatesInitializationService } from 'core-app/features/work-packages/components/wp-list/wp-states-initialization.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { HalResourceService } from 'core-app/features/hal/services/hal-resource.service';\nimport { WorkPackageViewFiltersService } from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-filters.service';\nimport { QueryFilterInstanceResource } from 'core-app/features/hal/resources/query-filter-instance-resource';\nimport { UrlParamsHelperService } from 'core-app/features/work-packages/components/wp-query/url-params-helper';\nimport { StateService } from '@uirouter/core';\nimport { debounceTime, skip, take } from 'rxjs/operators';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { Observable } from 'rxjs';\nimport { BoardFiltersService } from 'core-app/features/boards/board/board-filter/board-filters.service';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\n\n@Component({\n  selector: 'board-filter',\n  templateUrl: './board-filter.component.html',\n})\nexport class BoardFilterComponent extends UntilDestroyedMixin implements AfterViewInit {\n  /** Current active */\n  @Input() public board$:Observable<Board>;\n\n  initialized = false;\n\n  constructor(private readonly currentProjectService:CurrentProjectService,\n    private readonly querySpace:IsolatedQuerySpace,\n    private readonly apiV3Service:ApiV3Service,\n    private readonly halResourceService:HalResourceService,\n    private readonly wpStatesInitialization:WorkPackageStatesInitializationService,\n    private readonly wpTableFilters:WorkPackageViewFiltersService,\n    private readonly urlParamsHelper:UrlParamsHelperService,\n    private readonly boardFilters:BoardFiltersService,\n    private readonly $state:StateService) {\n    super();\n  }\n\n  ngAfterViewInit():void {\n    if (!this.board$) {\n      return;\n    }\n\n    this.board$\n      .pipe(take(1))\n      .subscribe((board) => {\n        // Initially load the form once to be able to render filters\n        this.loadQueryForm();\n\n        // Update checksum service whenever filters change\n        this.updateChecksumOnFilterChanges();\n\n        // Remove action attribute from filter service\n        if (board.isAction) {\n          this.wpTableFilters.hidden.push(board.actionAttribute!);\n        }\n      });\n  }\n\n  private updateChecksumOnFilterChanges() {\n    this.wpTableFilters\n      .live$()\n      .pipe(\n        this.untilDestroyed(),\n        skip(1),\n        debounceTime(250),\n      )\n      .subscribe(() => {\n        const filters:QueryFilterInstanceResource[] = this.wpTableFilters.current;\n        const filterHash = this.urlParamsHelper.buildV3GetFilters(filters);\n        const query_props = JSON.stringify(filterHash);\n\n        this.boardFilters.filters.putValue(filterHash);\n\n        this.$state.go('.', { query_props }, { custom: { notify: false } });\n      });\n  }\n\n  private loadQueryForm() {\n    this\n      .apiV3Service\n      .queries\n      .form\n      .loadWithParams(\n        { filters: JSON.stringify(this.boardFilters.current) },\n        undefined,\n        this.currentProjectService.id,\n      )\n      .subscribe(([form, query]) => {\n        this.querySpace.query.putValue(query);\n        this.wpStatesInitialization.updateStatesFromForm(query, form);\n      });\n  }\n}\n","<op-filter-container></op-filter-container>\n","import {\n  ApplicationRef,\n  ChangeDetectorRef,\n  Component,\n  ComponentFactoryResolver,\n  ElementRef,\n  Inject,\n  Injector,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n} from '@angular/core';\nimport { OpModalLocalsMap } from 'core-app/shared/components/modal/modal.types';\nimport { OpModalComponent } from 'core-app/shared/components/modal/modal.component';\nimport { OpModalLocalsToken } from 'core-app/shared/components/modal/modal.service';\nimport {\n  ActiveTabInterface,\n  TabComponent,\n  TabInterface,\n  TabPortalOutlet,\n} from 'core-app/features/work-packages/components/wp-table/configuration-modal/tab-portal-outlet';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { BoardConfigurationService } from 'core-app/features/boards/board/configuration-modal/board-configuration.service';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { Board } from 'core-app/features/boards/board/board';\n\n@Component({\n  templateUrl: './board-configuration.modal.html',\n})\nexport class BoardConfigurationModalComponent extends OpModalComponent implements OnInit, OnDestroy {\n  /* Close on escape? */\n  public closeOnEscape = false;\n\n  /* Close on outside click */\n  public closeOnOutsideClick = false;\n\n  public text = {\n    title: this.I18n.t('js.boards.configuration_modal.title'),\n    closePopup: this.I18n.t('js.close_popup_title'),\n\n    applyButton: this.I18n.t('js.modals.button_apply'),\n    cancelButton: this.I18n.t('js.modals.button_cancel'),\n  };\n\n  // Get the view child we'll use as the portal host\n  @ViewChild('tabContentOutlet', { static: true }) tabContentOutlet:ElementRef;\n\n  // And a reference to the actual portal host interface\n  public tabPortalHost:TabPortalOutlet;\n\n  constructor(@Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n    readonly I18n:I18nService,\n    readonly boardService:BoardService,\n    readonly boardConfigurationService:BoardConfigurationService,\n    readonly injector:Injector,\n    readonly appRef:ApplicationRef,\n    readonly componentFactoryResolver:ComponentFactoryResolver,\n    readonly cdRef:ChangeDetectorRef,\n    readonly elementRef:ElementRef) {\n    super(locals, cdRef, elementRef);\n  }\n\n  ngOnInit() {\n    this.$element = jQuery(this.elementRef.nativeElement);\n\n    this.tabPortalHost = new TabPortalOutlet(\n      this.boardConfigurationService.tabs,\n      this.tabContentOutlet.nativeElement,\n      this.componentFactoryResolver,\n      this.appRef,\n      this.injector,\n    );\n\n    setTimeout(() => {\n      const initialTab = this.availableTabs[0];\n      this.switchTo(initialTab);\n    });\n  }\n\n  ngOnDestroy() {\n    this.tabPortalHost.dispose();\n  }\n\n  public get availableTabs():TabInterface[] {\n    return this.tabPortalHost.availableTabs;\n  }\n\n  public get currentTab():ActiveTabInterface|null {\n    return this.tabPortalHost.currentTab;\n  }\n\n  public switchTo(tab:TabInterface) {\n    this.tabPortalHost.switchTo(tab);\n  }\n\n  public saveChanges():void {\n    this.tabPortalHost.activeComponents.forEach((component:TabComponent) => {\n      component.onSave();\n    });\n\n    const board = this.locals.board as Board;\n    this.boardService\n      .save(board)\n      .subscribe(() => {\n        this.service.close();\n      });\n  }\n\n  /**\n   * Called when the user attempts to close the modal window.\n   * The service will close this modal if this method returns true\n   * @returns {boolean}\n   */\n  public onClose():boolean {\n    this.afterFocusOn.focus();\n    return true;\n  }\n\n  protected get afterFocusOn():JQuery {\n    return this.$element;\n  }\n}\n","<div\n  class=\"spot-modal loading-indicator--location\"\n  data-indicator-name=\"modal\"\n>\n  <div class=\"spot-modal--header\">{{text.title}}</div>\n\n  <div class=\"spot-divider\"></div>\n\n  <div class=\"spot-modal--body spot-container\">\n    <div class=\"tab-content\" #tabContentOutlet></div>\n  </div>\n\n  <div class=\"spot-action-bar\">\n    <div class=\"spot-action-bar--right\">\n      <button\n        class=\"button button_no-margin spot-action-bar--action\"\n        [textContent]=\"text.cancelButton\"\n        (click)=\"closeMe($event)\"\n      ></button>\n      <button\n        class=\"button button_no-margin -highlight spot-action-bar--action\"\n        [textContent]=\"text.applyButton\"\n        (click)=\"saveChanges()\"\n      ></button>\n    </div>\n  </div>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  Directive, ElementRef, Injector, Input,\n} from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { OpContextMenuTrigger } from 'core-app/shared/components/op-context-menu/handlers/op-context-menu-trigger.directive';\nimport { OPContextMenuService } from 'core-app/shared/components/op-context-menu/op-context-menu.service';\nimport { OpModalService } from 'core-app/shared/components/modal/modal.service';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { BoardConfigurationModalComponent } from 'core-app/features/boards/board/configuration-modal/board-configuration.modal';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { StateService } from '@uirouter/core';\nimport { ToastService } from 'core-app/shared/components/toaster/toast.service';\nimport { triggerEditingEvent } from 'core-app/shared/components/editable-toolbar-title/editable-toolbar-title.component';\n\n@Directive({\n  selector: '[boardsToolbarMenu]',\n})\nexport class BoardsToolbarMenuDirective extends OpContextMenuTrigger {\n  @Input('boardsToolbarMenu-resource') public board:Board;\n\n  public text = {\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n  };\n\n  constructor(readonly elementRef:ElementRef,\n    readonly opContextMenu:OPContextMenuService,\n    readonly opModalService:OpModalService,\n    readonly boardService:BoardService,\n    readonly Notifications:ToastService,\n    readonly State:StateService,\n    readonly injector:Injector,\n    readonly I18n:I18nService) {\n    super(elementRef, opContextMenu);\n  }\n\n  public get locals() {\n    return {\n      contextMenuId: 'boardsToolbarMenu',\n      items: this.items,\n    };\n  }\n\n  protected open(evt:JQuery.TriggeredEvent) {\n    this.buildItems();\n    this.opContextMenu.show(this, evt);\n  }\n\n  private buildItems() {\n    this.items = [\n      {\n        // Configuration modal\n        linkText: this.I18n.t('js.toolbar.settings.configure_view'),\n        icon: 'icon-settings',\n        onClick: () => {\n          this.opContextMenu.close();\n          this.opModalService.show(BoardConfigurationModalComponent, this.injector, { board: this.board });\n\n          return true;\n        },\n      },\n      {\n        // Rename query shortcut\n        linkText: this.I18n.t('js.toolbar.settings.page_settings'),\n        icon: 'icon-edit',\n        onClick: () => {\n          if (this.board.grid.updateImmediately) {\n            jQuery('.toolbar-container .editable-toolbar-title--input').trigger(triggerEditingEvent);\n          }\n\n          return true;\n        },\n      },\n      {\n        // Delete query\n        linkText: this.I18n.t('js.toolbar.settings.delete'),\n        icon: 'icon-delete',\n        onClick: () => {\n          if (this.board.grid.delete\n            && window.confirm(this.I18n.t('js.text_query_destroy_confirmation'))) {\n            this.boardService\n              .delete(this.board)\n              .then(() => {\n                this.State.go('boards.list', { flash_message: { type: 'success', message: this.text.deleteSuccessful } });\n              });\n          }\n\n          return true;\n        },\n      },\n    ];\n  }\n}\n","import { Component, Input } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { Observable } from 'rxjs';\n\n@Component({\n  template: `\n    <button title=\"{{ text.button_more }}\"\n            class=\"button last board--settings-dropdown toolbar-icon\"\n            boardsToolbarMenu\n            [boardsToolbarMenu-resource]=\"board$ | async\">\n      <op-icon icon-classes=\"button--icon icon-show-more\"></op-icon>\n    </button>\n  `,\n})\nexport class BoardsMenuButtonComponent {\n  @Input() board$:Observable<Board>;\n\n  text = {\n    button_more: this.I18n.t('js.button_more'),\n  };\n\n  constructor(readonly I18n:I18nService) {\n  }\n}\n","import { Observable, Subject } from 'rxjs';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport { switchMap, takeUntil } from 'rxjs/operators';\n\nexport type RequestSwitchmapHandler<T, R> = (input:T) => Observable<R>;\n\nexport class RequestSwitchmap<T, R = HalResource> {\n  /** Input request state */\n  private requests = new Subject<T>();\n\n  /** Output switchmap observable */\n  private responses$ = this.requests\n    .pipe(\n      // Stream the request, switchMap will result in previous requests to be cancelled\n      switchMap(this.handler),\n    );\n\n  /**\n   *\n   * @param handler switch map handler function to output a response observable\n   */\n  constructor(readonly handler:RequestSwitchmapHandler<T, R>) {\n  }\n\n  /**\n   * Append a new request for the given request value and pass\n   * that to the switchmap handler\n   * @param newValue\n   */\n  public request(newValue:T) {\n    this.requests.next(newValue);\n  }\n\n  /**\n   * Observe the switched response\n   */\n  public observe(until:Observable<unknown>) {\n    return this\n      .responses$\n      .pipe(\n        takeUntil(until),\n      );\n  }\n}\n","<div class=\"work-packages-partitioned-query-space--container\"\n     [ngClass]=\"currentPartition\">\n  <div class=\"toolbar-container -editable\">\n    <div class=\"toolbar\">\n      <op-back-button *ngIf=\"backButtonCallback\"\n                      class=\"op-back-button\"\n                      linkClass=\"op-back-button_mobile-limited-width\"\n                      [customBackMethod]=\"backButtonCallback\">\n      </op-back-button>\n\n      <editable-toolbar-title [title]=\"selectedTitle\"\n                              [inFlight]=\"toolbarDisabled\"\n                              [showSaveCondition]=\"showToolbarSaveButton\"\n                              (onSave)=\"changeChangesFromTitle($event)\"\n                              (onEmptySubmit)=\"updateTitleName('')\"\n                              [editable]=\"titleEditingEnabled\">\n      </editable-toolbar-title>\n\n      <ul class=\"toolbar-items hide-when-print\"\n          *ngIf=\"showToolbar\">\n        <ng-container *ngFor=\"let definition of toolbarButtonComponents\">\n          <li class=\"toolbar-item\"\n              *ngIf=\"!definition.show || definition.show()\"\n              [ngClass]=\"definition.containerClasses\">\n            <ndc-dynamic [ndcDynamicComponent]=\"definition.component\"\n                         [ndcDynamicInputs]=\"definition.inputs\"\n                         [ndcDynamicInjector]=\"injector\"\n                         [ndcDynamicOutputs]=\"definition.outputs\">\n            </ndc-dynamic>\n          </li>\n        </ng-container>\n      </ul>\n    </div>\n  </div>\n\n  <div class=\"work-packages-partitioned-query-space--filter-area\">\n    <ndc-dynamic *ngIf=\"filterContainerDefinition\"\n                 [ndcDynamicComponent]=\"filterContainerDefinition.component\"\n                 [ndcDynamicInputs]=\"filterContainerDefinition.inputs\"\n                 [ndcDynamicOutputs]=\"filterContainerDefinition.outputs\"\n                 [ndcDynamicInjector]=\"injector\">\n    </ndc-dynamic>\n  </div>\n\n  <div class=\"work-packages-partitioned-page--content-container\">\n    <!-- Left content view -->\n    <div class=\"work-packages-partitioned-page--content-left loading-indicator--location\"\n         data-indicator-name=\"table\"\n         ui-view=\"content-left\">\n    </div>\n\n    <!-- Right content view -->\n    <div class=\"work-packages-partitioned-page--content-right\"\n         ui-view=\"content-right\"></div>\n  </div>\n</div>\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Injector,\n} from '@angular/core';\nimport {\n  DynamicComponentDefinition,\n  ToolbarButtonComponentDefinition,\n  ViewPartitionState,\n} from 'core-app/features/work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component';\nimport { StateService, TransitionService } from '@uirouter/core';\nimport { BoardFilterComponent } from 'core-app/features/boards/board/board-filter/board-filter.component';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { ToastService } from 'core-app/shared/components/toaster/toast.service';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { DragAndDropService } from 'core-app/shared/helpers/drag-and-drop/drag-and-drop.service';\nimport { WorkPackageFilterButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/wp-filter-button/wp-filter-button.component';\nimport { ZenModeButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/zen-mode-toggle-button/zen-mode-toggle-button.component';\nimport { BoardsMenuButtonComponent } from 'core-app/features/boards/board/toolbar-menu/boards-menu-button.component';\nimport { RequestSwitchmap } from 'core-app/shared/helpers/rxjs/request-switchmap';\nimport { componentDestroyed } from '@w11k/ngx-componentdestroyed';\nimport { finalize, take } from 'rxjs/operators';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { Ng2StateDeclaration } from '@uirouter/angular';\nimport { BoardFiltersService } from 'core-app/features/boards/board/board-filter/board-filters.service';\nimport { CardViewHandlerRegistry } from 'core-app/features/work-packages/components/wp-card-view/event-handler/card-view-handler-registry';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { OpTitleService } from 'core-app/core/html/op-title.service';\n\nexport function boardCardViewHandlerFactory(injector:Injector) {\n  return new CardViewHandlerRegistry(injector);\n}\n\n@Component({\n  templateUrl: '../../../work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html',\n  styleUrls: [\n    '../../../work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.sass',\n    './board-partitioned-page.component.sass',\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    DragAndDropService,\n    BoardFiltersService,\n  ],\n})\nexport class BoardPartitionedPageComponent extends UntilDestroyedMixin {\n  text = {\n    button_more: this.I18n.t('js.button_more'),\n    delete: this.I18n.t('js.button_delete'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n    updateSuccessful: this.I18n.t('js.notice_successful_update'),\n    unnamedBoard: this.I18n.t('js.boards.label_unnamed_board'),\n    loadingError: 'No such board found',\n    addList: this.I18n.t('js.boards.add_list'),\n    upsaleBoards: this.I18n.t('js.boards.upsale.teaser_text'),\n    upsaleCheckOutLink: this.I18n.t('js.work_packages.table_configuration.upsale.check_out_link'),\n    unnamed_list: this.I18n.t('js.boards.label_unnamed_list'),\n  };\n\n  /** Board observable */\n  board$ = this\n    .apiV3Service\n    .boards\n    .id(this.state.params.board_id.toString())\n    .observe();\n\n  /** Whether this is a new board just created */\n  isNew = !!this.state.params.isNew;\n\n  /** Whether the board is editable */\n  editable:boolean;\n\n  /** Go back to boards using back-button */\n  backButtonCallback:() => void;\n\n  /** Current query title to render */\n  selectedTitle?:string;\n\n  currentQuery:QueryResource|undefined;\n\n  /** Whether we're saving the board */\n  toolbarDisabled = false;\n\n  /** Do we currently have query props ? */\n  showToolbarSaveButton:boolean;\n\n  /** Listener callbacks */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  removeTransitionSubscription:Function;\n\n  /** Show a toolbar */\n  showToolbar = true;\n\n  /** Whether filtering is allowed */\n  filterAllowed = true;\n\n  /** We need to pass the correct partition state to the view to manage the grid */\n  currentPartition:ViewPartitionState = '-split';\n\n  /** We need to apply our own board filter component */\n  /** Which filter container component to mount */\n  filterContainerDefinition:DynamicComponentDefinition = {\n    component: BoardFilterComponent,\n    inputs: {\n      board$: this.board$,\n    },\n  };\n\n  // We remember when we want to update the board\n  boardSaver = new RequestSwitchmap(\n    (board:Board) => {\n      this.toolbarDisabled = true;\n      return this.Boards\n        .save(board)\n        .pipe(\n          finalize(() => (this.toolbarDisabled = false)),\n        );\n    },\n  );\n\n  toolbarButtonComponents:ToolbarButtonComponentDefinition[] = [\n    {\n      component: WorkPackageFilterButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n    },\n    {\n      component: ZenModeButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n    },\n    {\n      component: BoardsMenuButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n      show: () => this.editable,\n      inputs: {\n        board$: this.board$,\n      },\n    },\n  ];\n\n  constructor(readonly I18n:I18nService,\n    readonly cdRef:ChangeDetectorRef,\n    readonly $transitions:TransitionService,\n    readonly state:StateService,\n    readonly toastService:ToastService,\n    readonly halNotification:HalResourceNotificationService,\n    readonly injector:Injector,\n    readonly apiV3Service:ApiV3Service,\n    readonly boardFilters:BoardFiltersService,\n    readonly Boards:BoardService,\n    readonly titleService:OpTitleService) {\n    super();\n  }\n\n  ngOnInit():void {\n    // Ensure board is being loaded\n    this.Boards.loadAllBoards();\n\n    this.boardSaver\n      .observe(componentDestroyed(this))\n      .subscribe(\n        () => {\n          this.toastService.addSuccess(this.text.updateSuccessful);\n        },\n        (error:unknown) => this.halNotification.handleRawError(error),\n      );\n\n    this.removeTransitionSubscription = this.$transitions.onSuccess({}, (transition):any => {\n      const toState = transition.to();\n      const params = transition.params('to');\n\n      this.showToolbarSaveButton = !!params.query_props;\n      this.setPartition(toState);\n\n      this\n        .board$\n        .pipe(take(1))\n        .subscribe((board) => {\n          this.titleService.setFirstPart(board.name);\n        });\n\n      this.cdRef.detectChanges();\n    });\n\n    this.board$\n      .pipe(\n        this.untilDestroyed(),\n      )\n      .subscribe((board) => {\n        const queryProps = this.state.params.query_props;\n        this.editable = board.editable;\n        this.selectedTitle = board.name;\n        this.titleService.setFirstPart(board.name);\n        this.boardFilters.filters.putValue(queryProps ? JSON.parse(queryProps) : board.filters);\n\n        this.cdRef.detectChanges();\n      });\n  }\n\n  ngOnDestroy():void {\n    super.ngOnDestroy();\n    this.removeTransitionSubscription();\n  }\n\n  changeChangesFromTitle(newName:string) {\n    this.board$\n      .pipe(take(1))\n      .subscribe((board) => {\n        board.name = newName;\n        board.filters = this.boardFilters.current;\n\n        const params = { isNew: false, query_props: null };\n        this.state.go('.', params, { custom: { notify: false } });\n\n        this.boardSaver.request(board);\n      });\n  }\n\n  updateTitleName(val:string) {\n    this.changeChangesFromTitle(val);\n  }\n\n  /** Whether the title can be edited */\n  get titleEditingEnabled():boolean {\n    return this.editable;\n  }\n\n  /**\n   * We need to set the current partition to the grid to ensure\n   * either side gets expanded to full width if we're not in '-split' mode.\n   *\n   * @param state The current or entering state\n   */\n  protected setPartition(state:Ng2StateDeclaration) {\n    this.currentPartition = (state.data && state.data.partition) ? state.data.partition : '-split';\n  }\n}\n","<div\n  class=\"spot-modal spot-modal_autoheight confirm-form-submit--modal loading-indicator--location\"\n  data-indicator-name=\"modal\"\n>\n  <div class=\"spot-modal--header\">{{text.title}}</div>\n\n  <div class=\"spot-divider\"></div>\n\n  <div class=\"spot-modal--body spot-container\">\n    <div *ngIf=\"showWarning && warningText\"\n         class=\"op-toast -warning\">\n      <div class=\"op-toast--content\">\n        <p [innerHTML]=\"warningText\"></p>\n      </div>\n    </div>\n\n    <div class=\"form--field\">\n      <div class=\"form--field-container\">\n        <div class=\"form--select-container\">\n          <label class=\"form--label\" [textContent]=\"actionService.label\"></label>\n          <op-autocompleter\n            #select\n            classes=\"new-list--action-select\"\n            appendTo=\"body\"\n            [resource]=\"autocompleterOptions.resource\"\n            [openDirectly]=\"true\"\n            [fetchDataDirectly]=\"true\"\n            [getOptionsFn]=autocompleterOptions.getOptionsFn\n            (change)=\"onModelChange($event)\"\n          >\n            <ng-template op-autocompleter-footer-tmp *ngIf=\"autocompleterOptions.resource=='version'\" let-search>\n              <button\n                class=\"op-select-footer--label\"\n                type=\"button\"\n                (click)=\"onNewActionCreated()\">\n                  <span class=\"icon-context\">\n                    <op-icon icon-classes=\"icon-plus icon-context\"></op-icon>\n                    {{text.button_create}} {{ngSelectComponent.ngSelectInstance.searchTerm}}\n                  </span>\n              </button>\n\n            </ng-template>\n          </op-autocompleter>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"spot-action-bar\">\n    <div class=\"spot-action-bar--right\">\n      <button\n        class=\"button button_no-margin spot-action-bar--action\"\n        data-qa-selector=\"confirmation-modal--cancel\"\n        (click)=\"closeMe($event)\"\n        [textContent]=\"text.button_cancel\"\n        [attr.title]=\"text.button_cancel\"\n      ></button>\n      <button\n        class=\"button button_no-margin -highlight spot-action-bar--action\"\n        data-qa-selector=\"confirmation-modal--confirmed\"\n        (click)=\"create()\"\n        [disabled]=\"!this.selectedAttribute || inFlight\"\n        [textContent]=\"text.button_add\"\n        [attr.title]=\"text.button_add\"\n      ></button>\n    </div>\n  </div>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectorRef, Component, ElementRef, Inject, OnInit, ViewChild,\n} from '@angular/core';\nimport { OpModalLocalsMap } from 'core-app/shared/components/modal/modal.types';\nimport { OpModalComponent } from 'core-app/shared/components/modal/modal.component';\nimport { OpModalLocalsToken } from 'core-app/shared/components/modal/modal.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { Board } from 'core-app/features/boards/board/board';\nimport { StateService } from '@uirouter/core';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { BoardActionsRegistryService } from 'core-app/features/boards/board/board-actions/board-actions-registry.service';\nimport { BoardActionService } from 'core-app/features/boards/board/board-actions/board-action.service';\nimport { trackByHref } from 'core-app/shared/helpers/angular/tracking-functions';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { tap } from 'rxjs/operators';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { Observable } from 'rxjs';\nimport { OpAutocompleterComponent } from 'core-app/shared/components/autocompleter/op-autocompleter/op-autocompleter.component';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\n\n@Component({\n  templateUrl: './add-list-modal.html',\n})\nexport class AddListModalComponent extends OpModalComponent implements OnInit {\n  @ViewChild(OpAutocompleterComponent, { static: true }) public ngSelectComponent:OpAutocompleterComponent;\n\n  getAutocompleterData = (searchTerm:string):Observable<HalResource[]> => {\n    // Remove prefix # from search\n    searchTerm = searchTerm.replace(/^#/, '');\n    return this.actionService.loadAvailable(this.active, searchTerm)\n      .pipe(tap((values) => (this.warnIfNoOptions(values))));\n  };\n\n  public autocompleterOptions = {\n    resource: '',\n    getOptionsFn: this.getAutocompleterData,\n  };\n\n  public showClose:boolean;\n\n  public confirmed = false;\n\n  /** Active board */\n  public board:Board;\n\n  /** Current active set of values */\n  public active:Set<string>;\n\n  /** Action service used by the board */\n  public actionService:BoardActionService;\n\n  /** The selected attribute */\n  public selectedAttribute:HalResource|undefined;\n\n  /** avoid double click */\n  public inFlight = false;\n\n  public trackByHref = trackByHref;\n\n  /* Do not close on outside click (because the select option are appended to the body */\n  public closeOnOutsideClick = false;\n\n  public warningText:string|undefined;\n\n  public text:any = {\n    title: this.I18n.t('js.boards.add_list'),\n    button_add: this.I18n.t('js.button_add'),\n    button_create: this.I18n.t('js.button_create'),\n    button_cancel: this.I18n.t('js.button_cancel'),\n    close_popup: this.I18n.t('js.close_popup_title'),\n\n    free_board: this.I18n.t('js.boards.board_type.free'),\n    free_board_text: this.I18n.t('js.boards.board_type.free_text'),\n\n    action_board: this.I18n.t('js.boards.board_type.action'),\n    action_board_text: this.I18n.t('js.boards.board_type.action_text'),\n    select_attribute: this.I18n.t('js.boards.board_type.select_attribute'),\n    placeholder: this.I18n.t('js.placeholders.selection'),\n  };\n\n  /** Whether the no results warning is displayed */\n  showWarning = false;\n\n  constructor(readonly elementRef:ElementRef,\n    @Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n    readonly cdRef:ChangeDetectorRef,\n    readonly boardActions:BoardActionsRegistryService,\n    readonly halNotification:HalResourceNotificationService,\n    readonly state:StateService,\n    readonly boardService:BoardService,\n    readonly I18n:I18nService,\n    readonly apiV3Service:ApiV3Service,\n    readonly currentProject:CurrentProjectService) {\n    super(locals, cdRef, elementRef);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n    this.board = this.locals.board;\n    this.active = new Set(this.locals.active as string[]);\n    this.actionService = this.boardActions.get(this.board.actionAttribute!);\n    this.autocompleterOptions.resource = this.actionService.resourceName.toLowerCase();\n  }\n\n  onModelChange(element:HalResource) {\n    this.selectedAttribute = element;\n  }\n\n  create() {\n    this.inFlight = true;\n    this.actionService\n      .addColumnWithActionAttribute(this.board, this.selectedAttribute!)\n      .then((board) => this.boardService.save(board).toPromise())\n      .then((board) => {\n        this.inFlight = false;\n        this.closeMe();\n        this.state.go('boards.partitioned.show', { board_id: board.id, isNew: true });\n      })\n      .catch(() => (this.inFlight = false));\n  }\n\n  onNewActionCreated() {\n    this\n      .apiV3Service\n      .versions\n      .post(this.getVersionPayload(this.ngSelectComponent.ngSelectInstance.searchTerm))\n      .subscribe(\n        (version) => {\n          this.selectedAttribute = version;\n          this.create();\n        },\n        (error) => {\n          this.ngSelectComponent.closeSelect();\n          this.halNotification.handleRawError(error);\n        },\n      );\n  }\n\n  private getVersionPayload(name:string) {\n    const payload:any = {};\n    payload.name = name;\n    payload._links = {\n      definingProject: {\n        href: this.apiV3Service.projects.id(this.currentProject.id!).path,\n      },\n    };\n\n    return payload;\n  }\n\n  private warnIfNoOptions(values:unknown[]) {\n    let hasMember = false;\n    if (values.length === 0) {\n      if (this.ngSelectComponent.ngSelectInstance.searchTerm !== undefined && this.ngSelectComponent.ngSelectInstance.searchTerm !== '') {\n        hasMember = true;\n      } else {\n        hasMember = false;\n      }\n    } else {\n      hasMember = false;\n    }\n    this.actionService\n      .warningTextWhenNoOptionsAvailable(hasMember)\n      .then((text) => {\n        this.warningText = text;\n      })\n      .catch(() => {});\n    this.showWarning = this.ngSelectComponent.ngSelectInstance.searchTerm !== undefined && (values.length === 0);\n    this.cdRef.detectChanges();\n  }\n}\n","<ng-container *ngIf=\"(board$ | async) as board\">\n  <div\n    *ngIf=\"!eeShowBanners || board.isFree\"\n    class=\"boards-list--container\"\n    [ngClass]=\"{ '-free' : board.isFree }\"\n    #container\n    cdkDropList\n    [cdkDropListDisabled]=\"!board.editable\"\n    cdkDropListOrientation=\"horizontal\"\n    (cdkDropListDropped)=\"moveList(board, $event)\"\n  >\n    <div *ngFor=\"let boardWidget of boardWidgets; trackBy:trackByQueryId\"\n         class=\"boards-list--item\"\n         wp-isolated-query-space\n         cdkDrag\n         vsDragScroll\n         [cdkDragData]=\"boardWidget\"\n         [vsDragScrollContainer]=\"_container\">\n      <span *ngIf=\"board.editable\"\n            class=\"boards-list-item-handle icon icon-drag-handle\"\n            cdkDragHandle></span>\n      <board-list [resource]=\"boardWidget\"\n                  [board]=\"board\"\n                  (onRemove)=\"removeList(board, boardWidget)\"\n                  (visibilityChange)=\"changeVisibilityOfList(board, boardWidget, $event)\">\n      </board-list>\n    </div>\n    <span *ngIf=\"showHiddenListWarning\"\n          class=\"boards-list--tooltip tooltip--right\"\n          [attr.data-tooltip]=\"text.hiddenListWarning\">\n      <i class=\"icon icon-attention\"></i>\n    </span>\n\n    <div class=\"boards-list--add-item -no-text-select\"\n         *ngIf=\"board.editable\"\n         (click)=\"addList(board)\">\n      <div class=\"boards-list--add-item-text\">\n        <op-icon icon-classes=\"icon-add icon-context\"></op-icon>\n        <span [textContent]=\"text.addList\"></span>\n      </div>\n    </div>\n  </div>\n\n  <op-enterprise-banner\n    *ngIf=\"eeShowBanners\"\n    [moreInfoLink]=\"text.more_info_link\"\n    [leftMargin]=\"true\"\n    [linkMessage]=\"text.upgrade_to_ee_text\"\n    [textMessage]=\"text.teaser_text\"\n    opReferrer=\"boards#board-show\">\n  </op-enterprise-banner>\n</ng-container>\n","import { Component, ElementRef, Injector, OnInit, QueryList, ViewChild, ViewChildren } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { BoardListComponent } from 'core-app/features/boards/board/board-list/board-list.component';\nimport { StateService } from '@uirouter/core';\nimport { ToastService } from 'core-app/shared/components/toaster/toast.service';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { BoardListsService } from 'core-app/features/boards/board/board-list/board-lists.service';\nimport { OpModalService } from 'core-app/shared/components/modal/modal.service';\nimport { BoardService } from 'core-app/features/boards/board/board.service';\nimport { BannersService } from 'core-app/core/enterprise/banners.service';\nimport { DragAndDropService } from 'core-app/shared/helpers/drag-and-drop/drag-and-drop.service';\nimport { QueryUpdatedService } from 'core-app/features/boards/board/query-updated/query-updated.service';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { Board, BoardWidgetOption } from 'core-app/features/boards/board/board';\nimport { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\nimport { GridWidgetResource } from 'core-app/features/hal/resources/grid-widget-resource';\nimport { BoardPartitionedPageComponent } from 'core-app/features/boards/board/board-partitioned-page/board-partitioned-page.component';\nimport { AddListModalComponent } from 'core-app/features/boards/board/add-list-modal/add-list-modal.component';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { BoardListCrossSelectionService } from 'core-app/features/boards/board/board-list/board-list-cross-selection.service';\nimport { filter, tap } from 'rxjs/operators';\nimport { BoardActionsRegistryService } from 'core-app/features/boards/board/board-actions/board-actions-registry.service';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { WorkPackageStatesInitializationService } from 'core-app/features/work-packages/components/wp-list/wp-states-initialization.service';\nimport { enterpriseDocsUrl } from 'core-app/core/setup/globals/constants.const';\n\n@Component({\n  templateUrl: './board-list-container.component.html',\n  styleUrls: ['./board-list-container.component.sass'],\n  providers: [\n    BoardListCrossSelectionService,\n  ],\n})\nexport class BoardListContainerComponent extends UntilDestroyedMixin implements OnInit {\n  text = {\n    delete: this.I18n.t('js.button_delete'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n    updateSuccessful: this.I18n.t('js.notice_successful_update'),\n    loadingError: 'No such board found',\n    addList: this.I18n.t('js.boards.add_list'),\n    unnamedList: this.I18n.t('js.boards.label_unnamed_list'),\n    hiddenListWarning: this.I18n.t('js.boards.text_hidden_list_warning'),\n    teaser_text: this.I18n.t('js.boards.upsale.teaser_text'),\n    upgrade_to_ee_text: this.I18n.t('js.boards.upsale.upgrade'),\n    more_info_link: enterpriseDocsUrl.boards,\n  };\n\n  /** Container reference */\n  public _container:HTMLElement;\n\n  @ViewChild('container')\n  set container(v:ElementRef|undefined) {\n    // ViewChild reference may be undefined initially\n    // due to ngIf\n    if (v !== undefined) {\n      if (this._container === undefined) {\n        this.Drag.addScrollContainer(v.nativeElement);\n      }\n      setTimeout(() => (this._container = v.nativeElement));\n    }\n  }\n\n  /** Reference all query children to extract current actions */\n  @ViewChildren(BoardListComponent) lists:QueryList<BoardListComponent>;\n\n  trackByQueryId = (index:number, widget:GridWidgetResource) => widget.options.queryId;\n\n  board$:Observable<Board>;\n\n  boardWidgets:GridWidgetResource[] = [];\n\n  showHiddenListWarning:boolean = false;\n\n  eeShowBanners = this.Banner.eeShowBanners;\n\n  private currentQueryUpdatedMonitoring:Subscription;\n\n  constructor(readonly I18n:I18nService,\n    readonly state:StateService,\n    readonly toastService:ToastService,\n    readonly halNotification:HalResourceNotificationService,\n    readonly boardComponent:BoardPartitionedPageComponent,\n    readonly BoardList:BoardListsService,\n    readonly boardActionRegistry:BoardActionsRegistryService,\n    readonly opModalService:OpModalService,\n    readonly injector:Injector,\n    readonly apiV3Service:ApiV3Service,\n    readonly Boards:BoardService,\n    readonly Banner:BannersService,\n    readonly boardListCrossSelectionService:BoardListCrossSelectionService,\n    readonly wpStatesInitialization:WorkPackageStatesInitializationService,\n    readonly Drag:DragAndDropService,\n    readonly apiv3Service:ApiV3Service,\n    readonly QueryUpdated:QueryUpdatedService) {\n    super();\n  }\n\n  ngOnInit():void {\n    const id:string = this.state.params.board_id.toString();\n    this.board$ = this\n      .apiV3Service\n      .boards\n      .id(id)\n      .requireAndStream()\n      .pipe(\n        tap((board) => this.setupQueryUpdatedMonitoring(board)),\n      );\n\n    this.Boards.currentBoard$.next(id);\n\n    this.boardListCrossSelectionService\n      .selections()\n      .pipe(\n        this.untilDestroyed(),\n        filter((state) => state.focusedWorkPackage !== null),\n        filter(() => this.state.includes(`${this.state.current.data.baseRoute}.details`)),\n      ).subscribe((selection) => {\n      // Update split screen\n        this.state.go(`${this.state.current.data.baseRoute}.details`, { workPackageId: selection.focusedWorkPackage });\n      });\n  }\n\n  moveList(board:Board, event:CdkDragDrop<GridWidgetResource[]>) {\n    moveItemInArray(board.queries, event.previousIndex, event.currentIndex);\n    this.saveBoard(board);\n  }\n\n  removeList(board:Board, query:GridWidgetResource) {\n    board.removeQuery(query);\n    this.saveBoard(board);\n  }\n\n  addList(board:Board):any {\n    if (board.isFree) {\n      return this.BoardList\n        .addFreeQuery(board, { name: this.text.unnamedList })\n        .then((board) => this.Boards.save(board).toPromise())\n        .catch((error) => this.showError(error));\n    }\n    const active = this.getActionFiltersFromWidget(board);\n    this.opModalService.show(\n      AddListModalComponent,\n      this.injector,\n      { board, active },\n    );\n  }\n\n  changeVisibilityOfList(board:Board, boardWidget:GridWidgetResource, visible:boolean) {\n    if (!visible) {\n      this.showHiddenListWarning = true;\n      this.boardWidgets = this.boardWidgets.filter(widget => widget.id !== boardWidget.id);\n    }\n  }\n\n  saveBoard(board:Board):void {\n    this.boardComponent.boardSaver.request(board);\n  }\n\n  private setupQueryUpdatedMonitoring(board:Board) {\n    if (this.currentQueryUpdatedMonitoring) {\n      this.currentQueryUpdatedMonitoring.unsubscribe();\n    }\n\n    this.boardWidgets = board.queries;\n\n    this.currentQueryUpdatedMonitoring = this\n      .QueryUpdated\n      .monitor(board.queries.map((widget) => widget.options.queryId as string))\n      .pipe(\n        this.untilDestroyed(),\n      )\n      .subscribe((collection) => this.requestRefreshOfUpdatedLists(collection.elements));\n  }\n\n  private showError(text = this.text.loadingError) {\n    this.toastService.addError(text);\n  }\n\n  private requestRefreshOfUpdatedLists(queries:QueryResource[]) {\n    queries.forEach((query) => {\n      this\n        .lists\n        .filter((listComponent) => {\n          const id = query.id!.toString();\n          const listId = (listComponent.resource.options.queryId as string|number).toString();\n\n          return id === listId;\n        })\n        .forEach((listComponent) => listComponent.refreshQueryUnlessCaused(query, false));\n    });\n  }\n\n  /**\n   * Returns the current filter values for an action board.\n   * By extracting them from the widget options, we can avoid waiting for the queries\n   * to be loaded for each list\n   *\n   * @param board\n   */\n  private getActionFiltersFromWidget(board:Board):(string|null)[] {\n    return board.grid.widgets\n      .map((widget) => {\n        const service = this.boardActionRegistry.get(board.actionAttribute!);\n        const { filterName } = service;\n        const options:BoardWidgetOption = widget.options as any;\n        const filter = _.find(options.filters, (filter) => !!filter[filterName]);\n\n        if (filter) {\n          return (filter[filterName].values[0] || null) as any;\n        }\n      })\n      .filter((value) => value !== undefined);\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { Ng2StateDeclaration, UIRouter } from '@uirouter/angular';\nimport { BoardsRootComponent } from 'core-app/features/boards/boards-root/boards-root.component';\nimport { BoardsIndexPageComponent } from 'core-app/features/boards/index-page/boards-index-page.component';\nimport { BoardPartitionedPageComponent } from 'core-app/features/boards/board/board-partitioned-page/board-partitioned-page.component';\nimport { BoardListContainerComponent } from 'core-app/features/boards/board/board-partitioned-page/board-list-container.component';\nimport { makeSplitViewRoutes } from 'core-app/features/work-packages/routing/split-view-routes.template';\nimport { WorkPackageSplitViewComponent } from 'core-app/features/work-packages/routing/wp-split-view/wp-split-view.component';\n\nexport const menuItemClass = 'board-view-menu-item';\n\nexport const BOARDS_ROUTES:Ng2StateDeclaration[] = [\n  {\n    name: 'boards',\n    parent: 'optional_project',\n    // The trailing slash is important\n    // cf., https://community.openproject.com/wp/29754\n    url: '/boards/?query_props',\n    data: {\n      bodyClasses: 'router--boards-view-base',\n      menuItem: menuItemClass,\n    },\n    params: {\n      // Use custom encoder/decoder that ensures validity of URL string\n      query_props: { type: 'opQueryString', dynamic: true },\n    },\n    redirectTo: 'boards.list',\n    component: BoardsRootComponent,\n  },\n  {\n    name: 'boards.list',\n    component: BoardsIndexPageComponent,\n    data: {\n      parent: 'boards',\n      bodyClasses: 'router--boards-list-view',\n      menuItem: menuItemClass,\n    },\n  },\n  {\n    name: 'boards.partitioned',\n    url: '{board_id}',\n    params: {\n      board_id: { type: 'int' },\n      isNew: { type: 'bool', inherit: false, dynamic: true },\n    },\n    data: {\n      parent: 'boards',\n      bodyClasses: 'router--boards-full-view',\n      menuItem: menuItemClass,\n    },\n    reloadOnSearch: false,\n    component: BoardPartitionedPageComponent,\n    redirectTo: 'boards.partitioned.show',\n  },\n  {\n    name: 'boards.partitioned.show',\n    url: '',\n    data: {\n      baseRoute: 'boards.partitioned.show',\n    },\n    views: {\n      'content-left': { component: BoardListContainerComponent },\n    },\n  },\n  ...makeSplitViewRoutes(\n    'boards.partitioned.show',\n    menuItemClass,\n    WorkPackageSplitViewComponent,\n  ),\n];\n\nexport function uiRouterBoardsConfiguration(uiRouter:UIRouter) {\n  // Ensure boards/ are being redirected correctly\n  // cf., https://community.openproject.com/wp/29754\n  uiRouter.urlService.rules\n    .when(\n      new RegExp('^/projects/(.*)/boards$'),\n      (match) => `/projects/${match[1]}/boards/`,\n    );\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { NgModule } from '@angular/core';\nimport { OPSharedModule } from 'core-app/shared/shared.module';\nimport { OpenprojectWorkPackagesModule } from 'core-app/features/work-packages/openproject-work-packages.module';\nimport { OpenprojectModalModule } from 'core-app/shared/components/modal/modal.module';\nimport { UIRouterModule } from '@uirouter/angular';\nimport { BoardListComponent } from 'core-app/features/boards/board/board-list/board-list.component';\nimport { BoardsRootComponent } from 'core-app/features/boards/boards-root/boards-root.component';\nimport { BoardInlineAddAutocompleterComponent } from 'core-app/features/boards/board/inline-add/board-inline-add-autocompleter.component';\nimport { BoardsToolbarMenuDirective } from 'core-app/features/boards/board/toolbar-menu/boards-toolbar-menu.directive';\nimport { BoardConfigurationModalComponent } from 'core-app/features/boards/board/configuration-modal/board-configuration.modal';\nimport { BoardsIndexPageComponent } from 'core-app/features/boards/index-page/boards-index-page.component';\nimport { BoardsMenuComponent } from 'core-app/features/boards/boards-sidebar/boards-menu.component';\nimport { NewBoardModalComponent } from 'core-app/features/boards/new-board-modal/new-board-modal.component';\nimport { AddListModalComponent } from 'core-app/features/boards/board/add-list-modal/add-list-modal.component';\nimport { BoardHighlightingTabComponent } from 'core-app/features/boards/board/configuration-modal/tabs/highlighting-tab.component';\nimport { AddCardDropdownMenuDirective } from 'core-app/features/boards/board/add-card-dropdown/add-card-dropdown-menu.directive';\nimport { BoardFilterComponent } from 'core-app/features/boards/board/board-filter/board-filter.component';\nimport { DragScrollModule } from 'cdk-drag-scroll';\nimport { BoardListMenuComponent } from 'core-app/features/boards/board/board-list/board-list-menu.component';\nimport { VersionBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/version/version-board-header.component';\nimport { DynamicModule } from 'ng-dynamic-component';\nimport { BOARDS_ROUTES, uiRouterBoardsConfiguration } from 'core-app/features/boards/openproject-boards.routes';\nimport { BoardPartitionedPageComponent } from 'core-app/features/boards/board/board-partitioned-page/board-partitioned-page.component';\nimport { BoardListContainerComponent } from 'core-app/features/boards/board/board-partitioned-page/board-list-container.component';\nimport { BoardsMenuButtonComponent } from 'core-app/features/boards/board/toolbar-menu/boards-menu-button.component';\nimport { AssigneeBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/assignee/assignee-board-header.component';\nimport { SubprojectBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/subproject/subproject-board-header.component';\nimport { SubtasksBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/subtasks/subtasks-board-header.component';\nimport { StatusBoardHeaderComponent } from 'core-app/features/boards/board/board-actions/status/status-board-header.component';\nimport { OpenprojectAutocompleterModule } from 'core-app/shared/components/autocompleter/openproject-autocompleter.module';\nimport { TileViewComponent } from './tile-view/tile-view.component';\n\n@NgModule({\n  imports: [\n    OPSharedModule,\n    OpenprojectWorkPackagesModule,\n    OpenprojectModalModule,\n    DragScrollModule,\n    OpenprojectAutocompleterModule,\n\n    // Dynamic Module for actions\n    DynamicModule.withComponents([VersionBoardHeaderComponent]),\n\n    // Routes for /boards\n    UIRouterModule.forChild({\n      states: BOARDS_ROUTES,\n      config: uiRouterBoardsConfiguration,\n    }),\n  ],\n  declarations: [\n    BoardsIndexPageComponent,\n    BoardPartitionedPageComponent,\n    BoardListContainerComponent,\n    BoardListComponent,\n    BoardsRootComponent,\n    BoardInlineAddAutocompleterComponent,\n    BoardsMenuComponent,\n    BoardHighlightingTabComponent,\n    BoardConfigurationModalComponent,\n    BoardsToolbarMenuDirective,\n    BoardsMenuButtonComponent,\n    NewBoardModalComponent,\n    AddListModalComponent,\n    AddCardDropdownMenuDirective,\n    BoardListMenuComponent,\n    BoardFilterComponent,\n    VersionBoardHeaderComponent,\n    AssigneeBoardHeaderComponent,\n    SubprojectBoardHeaderComponent,\n    SubtasksBoardHeaderComponent,\n    StatusBoardHeaderComponent,\n    TileViewComponent,\n  ],\n})\nexport class OpenprojectBoardsModule {\n}\n"],"sourceRoot":"webpack:///","file":"src_app_features_boards_openproject-boards_module_ts.466148691beae1cdf256.js"}