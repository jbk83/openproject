{"version":3,"mappings":"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","names":["N","constructor","o","t","r","a","f","D","j","super","this","open","buildItems","opContextMenu","show","items","contextMenuId","viewerBridgeService","shouldShowViewer","c","map","hidden","bcfView","currentViewerState","linkText","text","icon","onClick","wpFiltersService","visible","toggleVisibility","update","g","e","selectors","live$","w","gonIFC","models","projects","shown_models","isSingleModel","shownModels","length","isDefaults","find","default","indexOf","id","manageIFCPath","paths","ifcModelsPath","currentProjectService","identifier","allowed","permissions","gon","get","d","factory","manage","I18n","ifcData","x","import","import_hover","handleClick","currentProject","bcfPathHelper","projectImportIssuePath","window","location","href","v","ie","ot","export","export_hover","ngOnInit","querySpace","query","values$","pipe","untilDestroyed","subscribe","queryUrlParamsHelper","buildV3GetFilters","filters","exportLink","projectExportIssuesPath","JSON","stringify","showDelayedExport","opModalService","ae","injector","link","preventDefault","k","refresh","refresh_hover","state","go","reload","y","R","title","delete","edit","areYouSure","component","ee","inputs","stateName$","newRoute","containerClasses","Q","U","ce","authorisationService","can","hideTableOptions","setupChangeObserver","displayRepresentation","filterAllowed","cdRef","detectChanges","loadQuery","then","initialize","results","_","K","we","empty_warning","use_this_link_to_manage","keyboard_input_disabled","ifcViewerService","inspectorVisible$","modelCount","xe","currentUserService","hasCapabilities$","viewInitialized$","ve","newViewer","canvasElement","modelCanvas","nativeElement","explorerElement","document","getElementsByClassName","toolbarElement","inspectorElement","navCubeCanvasElement","navCubeCanvas","busyModelBackdropElement","viewerContainer","keyboardEventsElement","enableEditModels","ngAfterViewInit","next","ngOnDestroy","destroy","toggleInspector","getValue","cancelAllKeyEvents","stopPropagation","enableKeyBoard","keyboardEnabled","setKeyboardEnabled","disableKeyboard","outerContainer","contains","enableFromIcon","focus","stopImmediatePropagation","C","Fe","dragAndDropEnabled","updateViewRepresentation","valueFromQuery","showTableView","deviceService","isMobile","showResizerInCardView","noResults","ifcModelsService","handleWorkPackageClicked","workPackageId","double","showViewPointInFlight","zone","runOutsideAngular","setTimeout","states","workPackages","value","viewer","viewerVisible","bcfViewpoints","showViewpoint","goToWpDetailState","uIRouterGlobals","params","cards","openStateLink","Se","$state","p","provide","Oe","useClass","Ae","Pe","Ze","l","b","Le","V","B","je","Me","showViewer$","L","I","showWorkPackages$","T","Ke","name","parent","url","abstract","ge","redirectTo","query_id","type","dynamic","query_props","viewpoint","data","bodyClasses","baseRoute","partition","reloadOnSearch","views","allowMovingInEditMode","successState","ue","F","u","A","imports","J","Xe","tt","et","E","M"],"sources":["./src/app/features/bim/ifc_models/toolbar/view-toggle/bcf-view-toggle-dropdown.directive.ts","./src/app/features/bim/ifc_models/toolbar/view-toggle/bcf-view-toggle-button.component.ts","./src/app/features/bim/ifc_models/pages/viewer/ifc-models-data.service.ts","./src/app/features/bim/ifc_models/toolbar/manage-ifc-models-button/bim-manage-ifc-models-button.component.ts","./src/app/features/bim/ifc_models/toolbar/import-export-bcf/bcf-import-button.component.ts","./src/app/features/bim/ifc_models/toolbar/import-export-bcf/bcf-export-button.component.ts","./src/app/features/bim/ifc_models/toolbar/import-export-bcf/refresh-button.component.ts","./src/app/features/work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html","./src/app/features/bim/ifc_models/pages/viewer/ifc-viewer-page.component.ts","./src/app/features/bim/ifc_models/ifc-viewer/ifc-viewer.component.html","./src/app/features/bim/ifc_models/ifc-viewer/ifc-viewer.component.ts","./src/app/features/bim/ifc_models/bcf/list/bcf-list.component.html","./src/app/features/bim/ifc_models/bcf/list/bcf-list.component.ts","./src/app/features/bim/ifc_models/bcf/split/left/bcf-split-left.component.html","./src/app/features/bim/ifc_models/bcf/split/left/bcf-split-left.component.ts","./src/app/features/bim/ifc_models/bcf/split/right/bcf-split-right.component.html","./src/app/features/bim/ifc_models/bcf/split/right/bcf-split-right.component.ts","./src/app/features/bim/ifc_models/openproject-ifc-models.routes.ts","./src/app/features/bim/ifc_models/openproject-ifc-models.module.ts"],"sourcesContent":["// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { OPContextMenuService } from 'core-app/shared/components/op-context-menu/op-context-menu.service';\nimport { Directive, ElementRef } from '@angular/core';\nimport { OpContextMenuTrigger } from 'core-app/shared/components/op-context-menu/handlers/op-context-menu-trigger.directive';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { StateService } from '@uirouter/core';\nimport {\n  bcfCardsViewIdentifier,\n  bcfSplitViewCardsIdentifier,\n  bcfSplitViewTableIdentifier,\n  bcfTableViewIdentifier,\n  bcfViewerViewIdentifier,\n  BcfViewService,\n} from 'core-app/features/bim/ifc_models/pages/viewer/bcf-view.service';\nimport { ViewerBridgeService } from 'core-app/features/bim/bcf/bcf-viewer-bridge/viewer-bridge.service';\nimport { WorkPackageFiltersService } from 'core-app/features/work-packages/components/filters/wp-filters/wp-filters.service';\nimport { OpContextMenuItem } from 'core-app/shared/components/op-context-menu/op-context-menu.types';\n\n@Directive({\n  selector: '[opBcfViewDropdown]',\n})\nexport class BcfViewToggleDropdownDirective extends OpContextMenuTrigger {\n  constructor(readonly elementRef:ElementRef,\n    readonly opContextMenu:OPContextMenuService,\n    readonly bcfView:BcfViewService,\n    readonly I18n:I18nService,\n    readonly state:StateService,\n    readonly wpFiltersService:WorkPackageFiltersService,\n    readonly viewerBridgeService:ViewerBridgeService) {\n    super(elementRef, opContextMenu);\n  }\n\n  protected open(evt:JQuery.TriggeredEvent):void {\n    this.buildItems();\n    this.opContextMenu.show(this, evt);\n  }\n\n  public get locals():{ showAnchorRight?:boolean, contextMenuId?:string, items:OpContextMenuItem[] } {\n    return {\n      items: this.items,\n      contextMenuId: 'bcf-view-context-menu',\n    };\n  }\n\n  private buildItems() {\n    const items = this.viewerBridgeService.shouldShowViewer\n      ? [bcfViewerViewIdentifier, bcfCardsViewIdentifier, bcfSplitViewCardsIdentifier, bcfSplitViewTableIdentifier, bcfTableViewIdentifier]\n      : [bcfCardsViewIdentifier, bcfTableViewIdentifier];\n\n    this.items = items\n      .map((key) => ({\n        hidden: key === this.bcfView.currentViewerState(),\n        linkText: this.bcfView.text[key],\n        icon: this.bcfView.icon[key],\n        onClick: () => {\n          // Close filter section\n          if (this.wpFiltersService.visible) {\n            this.wpFiltersService.toggleVisibility();\n          }\n\n          switch (key) {\n            case 'cards':\n            case 'table':\n            case 'viewer':\n            case 'splitCards':\n            case 'splitTable':\n              this.bcfView.update(key);\n              break;\n            default:\n          }\n\n          return true;\n        },\n      }));\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { BcfViewService } from 'core-app/features/bim/ifc_models/pages/viewer/bcf-view.service';\n\n@Component({\n  template: `\n    <ng-container *ngIf=\"(view$ | async) as current\">\n      <button class=\"button\"\n              id=\"bcf-view-toggle-button\"\n              opBcfViewDropdown>\n        <op-icon icon-classes=\"button--icon {{bcfView.icon[current]}}\"></op-icon>\n        <span class=\"button--text\"\n              aria-hidden=\"true\"\n              [textContent]=\"bcfView.text[current]\">\n        </span>\n        <op-icon icon-classes=\"button--icon icon-small icon-pulldown\"></op-icon>\n      </button>\n    </ng-container>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'op-bcf-view-toggle-button',\n})\nexport class BcfViewToggleButtonComponent {\n  view$ = this.bcfView.live$();\n\n  constructor(readonly I18n:I18nService, readonly bcfView:BcfViewService) { }\n}\n","import { Injectable } from '@angular/core';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { GonService } from 'core-app/core/gon/gon.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\n\nexport interface IFCPermissionMap {\n  manage_ifc_models:boolean;\n  manage_bcf:boolean;\n}\n\nexport interface IFCGonDefinition {\n  models:IfcModelDefinition[];\n  shown_models:number[];\n  projects:IfcProjectDefinition[];\n  xkt_attachment_ids:{ [id:number]:number };\n  permissions:IFCPermissionMap;\n}\n\nexport interface IfcProjectDefinition {\n  name:string;\n  id:string;\n}\n\nexport interface IfcModelDefinition {\n  name:string;\n  id:number;\n  default:boolean;\n}\n\n@Injectable()\nexport class IfcModelsDataService {\n  constructor(readonly paths:PathHelperService,\n    readonly currentProjectService:CurrentProjectService,\n    readonly gon:GonService) {\n  }\n\n  public get models():IfcModelDefinition[] {\n    return this.gonIFC.models;\n  }\n\n  public get projects():IfcProjectDefinition[] {\n    return this.gonIFC.projects;\n  }\n\n  public get shownModels():number[] {\n    return this.gonIFC.shown_models;\n  }\n\n  public isSingleModel() {\n    return this.shownModels.length === 1;\n  }\n\n  public isDefaults():boolean {\n    return !this\n      .models\n      .find((item) => item.default && this.shownModels.indexOf(item.id) === -1);\n  }\n\n  public get manageIFCPath() {\n    return this.paths.ifcModelsPath(this.currentProjectService.identifier!);\n  }\n\n  public allowed(permission:keyof IFCPermissionMap):boolean {\n    return !!this.gonIFC.permissions[permission];\n  }\n\n  private get gonIFC():IFCGonDefinition {\n    return (this.gon.get('ifc_models') as IFCGonDefinition);\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { IfcModelsDataService } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-models-data.service';\n\n@Component({\n  template: `\n    <a *ngIf=\"manageAllowed\"\n       class=\"button\"\n       [href]=\"manageIFCPath\">\n      <op-icon icon-classes=\"button--icon icon-settings2\"></op-icon>\n      <span class=\"button--text\"\n            [textContent]=\"text.manage\"\n            aria-hidden=\"true\"></span>\n    </a>\n\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'op-bcf-manage-ifc-button',\n})\nexport class BimManageIfcModelsButtonComponent {\n  text = {\n    manage: this.I18n.t('js.ifc_models.models.ifc_models'),\n  };\n\n  manageAllowed = this.ifcData.allowed('manage_ifc_models');\n\n  manageIFCPath = this.ifcData.manageIFCPath;\n\n  constructor(readonly I18n:I18nService,\n    readonly ifcData:IfcModelsDataService) {\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { Component } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { BcfPathHelperService } from 'core-app/features/bim/bcf/helper/bcf-path-helper.service';\n\n@Component({\n  template: `\n    <a [title]=\"text.import_hover\"\n      (click)=\"handleClick()\"\n      class=\"button import-bcf-button\">\n      <op-icon icon-classes=\"button--icon icon-import\"></op-icon>\n      <span class=\"button--text\"> {{text.import}} </span>\n    </a>\n  `,\n  selector: 'bcf-import-button',\n})\nexport class BcfImportButtonComponent {\n  public text = {\n    import: this.I18n.t('js.bcf.import'),\n    import_hover: this.I18n.t('js.bcf.import_bcf_xml_file'),\n  };\n\n  constructor(readonly I18n:I18nService,\n    readonly currentProject:CurrentProjectService,\n    readonly bcfPathHelper:BcfPathHelperService) {\n  }\n\n  public handleClick() {\n    const projectIdentifier = this.currentProject.identifier;\n    if (projectIdentifier) {\n      const url = this.bcfPathHelper.projectImportIssuePath(projectIdentifier);\n      window.location.href = url;\n    }\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  Component, Injector, OnDestroy, OnInit,\n} from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { BcfPathHelperService } from 'core-app/features/bim/bcf/helper/bcf-path-helper.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { UrlParamsHelperService } from 'core-app/features/work-packages/components/wp-query/url-params-helper';\nimport { StateService } from '@uirouter/core';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { OpModalService } from 'core-app/shared/components/modal/modal.service';\nimport { WpTableExportModalComponent } from 'core-app/shared/components/modals/export-modal/wp-table-export.modal';\n\n@Component({\n  template: `\n    <a [title]=\"text.export_hover\"\n       class=\"button export-bcf-button\"\n       [attr.href]=\"exportLink\"\n       (click)=\"showDelayedExport($event)\">\n      <op-icon icon-classes=\"button--icon icon-export\"></op-icon>\n      <span class=\"button--text\"> {{text.export}} </span>\n    </a>\n  `,\n  selector: 'bcf-export-button',\n})\nexport class BcfExportButtonComponent extends UntilDestroyedMixin implements OnInit, OnDestroy {\n  public text = {\n    export: this.I18n.t('js.bcf.export'),\n    export_hover: this.I18n.t('js.bcf.export_bcf_xml_file'),\n  };\n\n  public query:QueryResource;\n\n  public exportLink:string;\n\n  constructor(readonly I18n:I18nService,\n    readonly currentProject:CurrentProjectService,\n    readonly bcfPathHelper:BcfPathHelperService,\n    readonly querySpace:IsolatedQuerySpace,\n    readonly queryUrlParamsHelper:UrlParamsHelperService,\n    readonly opModalService:OpModalService,\n    readonly injector:Injector,\n    readonly state:StateService) {\n    super();\n  }\n\n  ngOnInit() {\n    this.querySpace.query\n      .values$()\n      .pipe(\n        this.untilDestroyed(),\n      )\n      .subscribe((query) => {\n        this.query = query;\n\n        const projectIdentifier = this.currentProject.identifier;\n        const filters = this.queryUrlParamsHelper.buildV3GetFilters(this.query.filters);\n        this.exportLink = this.bcfPathHelper.projectExportIssuesPath(\n          projectIdentifier!,\n          JSON.stringify(filters),\n        );\n      });\n  }\n\n  public showDelayedExport(event:any) {\n    this.opModalService.show(WpTableExportModalComponent, this.injector, { link: this.exportLink });\n    event.preventDefault();\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { StateService } from '@uirouter/core';\n\n@Component({\n  template: `\n    <a [title]=\"text.refresh_hover\"\n       class=\"button refresh-button\"\n       (click)=\"refresh()\">\n      <op-icon icon-classes=\"button--icon icon-workflow\"></op-icon>\n    </a>\n  `,\n  selector: 'op-refresh-button',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\n\nexport class RefreshButtonComponent {\n  public text = {\n    refresh: this.I18n.t('js.bcf.refresh'),\n    refresh_hover: this.I18n.t('js.bcf.refresh_work_package'),\n  };\n\n  constructor(readonly I18n:I18nService,\n    readonly state:StateService) {\n  }\n\n  refresh() {\n    void this.state.go('.', {}, { reload: true });\n  }\n}\n","<div class=\"work-packages-partitioned-query-space--container\"\n     [ngClass]=\"currentPartition\">\n  <div class=\"toolbar-container -editable\">\n    <div class=\"toolbar\">\n      <op-back-button *ngIf=\"backButtonCallback\"\n                      class=\"op-back-button\"\n                      linkClass=\"op-back-button_mobile-limited-width\"\n                      [customBackMethod]=\"backButtonCallback\">\n      </op-back-button>\n\n      <editable-toolbar-title [title]=\"selectedTitle\"\n                              [inFlight]=\"toolbarDisabled\"\n                              [showSaveCondition]=\"showToolbarSaveButton\"\n                              (onSave)=\"changeChangesFromTitle($event)\"\n                              (onEmptySubmit)=\"updateTitleName('')\"\n                              [editable]=\"titleEditingEnabled\">\n      </editable-toolbar-title>\n\n      <ul class=\"toolbar-items hide-when-print\"\n          *ngIf=\"showToolbar\">\n        <ng-container *ngFor=\"let definition of toolbarButtonComponents\">\n          <li class=\"toolbar-item\"\n              *ngIf=\"!definition.show || definition.show()\"\n              [ngClass]=\"definition.containerClasses\">\n            <ndc-dynamic [ndcDynamicComponent]=\"definition.component\"\n                         [ndcDynamicInputs]=\"definition.inputs\"\n                         [ndcDynamicInjector]=\"injector\"\n                         [ndcDynamicOutputs]=\"definition.outputs\">\n            </ndc-dynamic>\n          </li>\n        </ng-container>\n      </ul>\n    </div>\n  </div>\n\n  <div class=\"work-packages-partitioned-query-space--filter-area\">\n    <ndc-dynamic *ngIf=\"filterContainerDefinition\"\n                 [ndcDynamicComponent]=\"filterContainerDefinition.component\"\n                 [ndcDynamicInputs]=\"filterContainerDefinition.inputs\"\n                 [ndcDynamicOutputs]=\"filterContainerDefinition.outputs\"\n                 [ndcDynamicInjector]=\"injector\">\n    </ndc-dynamic>\n  </div>\n\n  <div class=\"work-packages-partitioned-page--content-container\">\n    <!-- Left content view -->\n    <div class=\"work-packages-partitioned-page--content-left loading-indicator--location\"\n         data-indicator-name=\"table\"\n         ui-view=\"content-left\">\n    </div>\n\n    <!-- Right content view -->\n    <div class=\"work-packages-partitioned-page--content-right\"\n         ui-view=\"content-right\"></div>\n  </div>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  Injector,\n  OnInit,\n  ViewEncapsulation,\n} from '@angular/core';\nimport {\n  PartitionedQuerySpacePageComponent,\n  ToolbarButtonComponentDefinition,\n} from 'core-app/features/work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component';\nimport { WorkPackageFilterButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/wp-filter-button/wp-filter-button.component';\nimport { ZenModeButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/zen-mode-toggle-button/zen-mode-toggle-button.component';\nimport {\n  bcfSplitViewCardsIdentifier,\n  bcfViewerViewIdentifier,\n  BcfViewService,\n} from 'core-app/features/bim/ifc_models/pages/viewer/bcf-view.service';\nimport { BcfViewToggleButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/view-toggle/bcf-view-toggle-button.component';\nimport { IfcModelsDataService } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-models-data.service';\nimport { QueryParamListenerService } from 'core-app/features/work-packages/components/wp-query/query-param-listener.service';\nimport { BimManageIfcModelsButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/manage-ifc-models-button/bim-manage-ifc-models-button.component';\nimport { WorkPackageCreateButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/wp-create-button/wp-create-button.component';\nimport { of } from 'rxjs';\nimport { BcfImportButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/import-export-bcf/bcf-import-button.component';\nimport { BcfExportButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/import-export-bcf/bcf-export-button.component';\nimport { RefreshButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/import-export-bcf/refresh-button.component';\nimport { ViewerBridgeService } from 'core-app/features/bim/bcf/bcf-viewer-bridge/viewer-bridge.service';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { WorkPackageSettingsButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/wp-settings-button/wp-settings-button.component';\n\n@Component({\n  templateUrl: '../../../../work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html',\n  styleUrls: [\n    '../../../../work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.sass',\n    './styles/generic.sass',\n  ],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    BcfViewService,\n    QueryParamListenerService,\n  ],\n  selector: 'op-ifc-viewer-page',\n})\nexport class IFCViewerPageComponent extends PartitionedQuerySpacePageComponent implements UntilDestroyedMixin, OnInit {\n  text = {\n    title: this.I18n.t('js.bcf.management'),\n    delete: this.I18n.t('js.button_delete'),\n    edit: this.I18n.t('js.button_edit'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n  };\n\n  private readonly newRoute = this.viewerBridgeService.shouldShowViewer\n    ? 'bim.partitioned.list.new'\n    : 'bim.partitioned.new';\n\n  toolbarButtonComponents:ToolbarButtonComponentDefinition[] = [\n    {\n      component: WorkPackageCreateButtonComponent,\n      inputs: {\n        stateName$: of(this.newRoute),\n        allowed: ['work_packages.createWorkPackage', 'work_package.copy'],\n      },\n    },\n    {\n      component: RefreshButtonComponent,\n      show: ():boolean => !this.viewerBridgeService.shouldShowViewer,\n    },\n    {\n      component: BcfImportButtonComponent,\n      show: ():boolean => this.ifcData.allowed('manage_bcf'),\n      containerClasses: 'hidden-for-mobile',\n    },\n    {\n      component: BcfExportButtonComponent,\n      show: ():boolean => this.ifcData.allowed('manage_bcf'),\n      containerClasses: 'hidden-for-mobile',\n    },\n    {\n      component: WorkPackageFilterButtonComponent,\n      show: ():boolean => this.bcfView.currentViewerState() !== 'viewer',\n    },\n    {\n      component: BcfViewToggleButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n    },\n    {\n      component: ZenModeButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n    },\n    {\n      component: BimManageIfcModelsButtonComponent,\n      // Hide 'Manage models' toolbar button on plugin environment (ie: Revit)\n      show: ():boolean => this.viewerBridgeService.shouldShowViewer\n        && this.ifcData.allowed('manage_ifc_models'),\n    },\n    {\n      component: WorkPackageSettingsButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n      show: ():boolean => this.authorisationService.can('query', 'updateImmediately'),\n      inputs: {\n        hideTableOptions: true,\n      },\n    },\n  ];\n\n  constructor(readonly ifcData:IfcModelsDataService,\n    readonly bcfView:BcfViewService,\n    readonly injector:Injector,\n    readonly viewerBridgeService:ViewerBridgeService) {\n    super(injector);\n  }\n\n  ngOnInit():void {\n    super.ngOnInit();\n\n    this.setupChangeObserver(this.bcfView);\n\n    this.querySpace.query.values$()\n      .pipe(this.untilDestroyed())\n      .subscribe((query) => {\n        const dr = query.displayRepresentation || bcfSplitViewCardsIdentifier;\n        this.filterAllowed = dr !== bcfViewerViewIdentifier;\n        this.cdRef.detectChanges();\n      });\n  }\n\n  /**\n   * Initialize the BcfViewService when the query of the isolated space is loaded\n   */\n  public loadQuery(firstPage = false):Promise<QueryResource> {\n    return super.loadQuery(firstPage)\n      .then((query) => {\n        this.bcfView.initialize(query, query.results);\n        return query;\n      });\n  }\n}\n","<div #outerContainer\n     class=\"op-ifc-viewer\">\n\n  <div *ngIf=\"modelCount === 0\" class=\"op-toast -info\">\n    <div class=\"op-toast--content\">\n      <p>\n        {{ text.empty_warning }}\n        <br/>\n        <a *ngIf=\"canManage\"\n           [href]=\"ifcData.manageIFCPath\"\n           target=\"_blank\"\n           [textContent]=\"text.use_this_link_to_manage\">\n        </a>\n      </p>\n    </div>\n  </div>\n\n  <div #viewerContainer\n       *ngIf=\"modelCount\"\n       class=\"op-ifc-viewer--container xeokit-busy-modal-backdrop\"\n       data-qa-selector=\"op-ifc-viewer--container\">\n\n    <div class=\"op-ifc-viewer--toolbar op-ifc-viewer--model-canvas-overlay\">\n      <div #toolbar\n           class=\"op-ifc-viewer--toolbar-container\"\n           data-qa-selector=\"op-ifc-viewer--toolbar-container\">\n      </div>\n\n      <div class=\"op-ifc-viewer--toolbar-info-button\">\n        <button class=\"icon-info1 xeokit-btn\"\n                [class.active]=\"inspectorVisible$ | async\"\n                (click)=\"toggleInspector()\">\n        </button>\n      </div>\n    </div>\n\n    <canvas #modelCanvas\n            class=\"op-ifc-viewer--model-canvas\"\n            data-qa-selector=\"op-ifc-viewer--model-canvas\"\n            tabindex=\"0\">\n    </canvas>\n\n    <div *ngIf=\"!keyboardEnabled\"\n         class=\"op-ifc-viewer--focus-warning op-ifc-viewer--model-canvas-overlay\">\n      <a class=\"op-ifc-viewer--keyboard-disabled-icon icon-no-color icon-input-disabled\"\n         (mousedown)=\"enableFromIcon($event)\"\n         [attr.title]=\"text.keyboard_input_disabled\">\n      </a>\n    </div>\n\n    <canvas #navCubeCanvas\n            class=\"op-ifc-viewer--nav-cube-canvas op-ifc-viewer--model-canvas-overlay\"\n            data-qa-selector=\"op-ifc-viewer--nav-cube-canvas\"></canvas>\n  </div>\n\n  <div #inspectorPane\n       class=\"op-ifc-viewer--inspector-container\"\n       [class.op-ifc-viewer--inspector-container-hidden]=\"!(inspectorVisible$ | async)\"\n       data-qa-selector=\"op-ifc-viewer--inspector-container\">\n  </div>\n</div>","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  HostListener,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n} from '@angular/core';\nimport { IFCViewerService } from 'core-app/features/bim/ifc_models/ifc-viewer/ifc-viewer.service';\nimport { IfcModelsDataService } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-models-data.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { CurrentUserService } from 'core-app/core/current-user/current-user.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport {\n  BehaviorSubject,\n  combineLatest,\n  Subject,\n} from 'rxjs';\nimport { take } from 'rxjs/operators';\n\n@Component({\n  selector: 'op-ifc-viewer',\n  templateUrl: './ifc-viewer.component.html',\n  styleUrls: ['./ifc-viewer.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class IFCViewerComponent implements OnInit, OnDestroy, AfterViewInit {\n  private viewInitialized$ = new Subject();\n\n  modelCount:number = this.ifcData.models.length;\n\n  canManage = this.ifcData.allowed('manage_ifc_models');\n\n  text = {\n    empty_warning: this.I18n.t('js.ifc_models.empty_warning'),\n    use_this_link_to_manage: this.I18n.t('js.ifc_models.use_this_link_to_manage'),\n    keyboard_input_disabled: this.I18n.t('js.ifc_models.keyboard_input_disabled'),\n  };\n\n  keyboardEnabled = false;\n\n  inspectorVisible$:BehaviorSubject<boolean> = this.ifcViewerService.inspectorVisible$;\n\n  @ViewChild('outerContainer') outerContainer:ElementRef;\n\n  @ViewChild('viewerContainer') viewerContainer:ElementRef;\n\n  @ViewChild('modelCanvas') modelCanvas:ElementRef;\n\n  @ViewChild('navCubeCanvas') navCubeCanvas:ElementRef;\n\n  @ViewChild('toolbar') toolbarElement:ElementRef;\n\n  @ViewChild('inspectorPane') inspectorElement:ElementRef;\n\n  constructor(\n    private I18n:I18nService,\n    private elementRef:ElementRef,\n    public ifcData:IfcModelsDataService,\n    private ifcViewerService:IFCViewerService,\n    private currentUserService:CurrentUserService,\n    private currentProjectService:CurrentProjectService,\n  ) {\n  }\n\n  ngOnInit():void {\n    if (this.modelCount === 0) {\n      return;\n    }\n\n    // we have to wait until view is initialized before constructing the ifc viewer,\n    // as it needs all view children ready and rendered\n    combineLatest([\n      this\n        .currentUserService\n        .hasCapabilities$(\n          [\n            'ifc_models/create',\n            'ifc_models/update',\n            'ifc_models/destroy',\n          ],\n          this.currentProjectService.id as string,\n        ),\n      this.viewInitialized$,\n    ])\n      .pipe(take(1))\n      .subscribe(([manageIfcModelsAllowed]) => {\n        this.ifcViewerService.newViewer(\n          {\n            canvasElement: this.modelCanvas.nativeElement as HTMLElement,\n            explorerElement: document.getElementsByClassName('op-ifc-viewer--tree-panel')[0] as HTMLElement, // Left panel\n            toolbarElement: this.toolbarElement.nativeElement as HTMLElement,\n            inspectorElement: this.inspectorElement.nativeElement as HTMLElement,\n            navCubeCanvasElement: this.navCubeCanvas.nativeElement as HTMLElement,\n            busyModelBackdropElement: this.viewerContainer.nativeElement as HTMLElement,\n            keyboardEventsElement: this.modelCanvas.nativeElement as HTMLElement,\n            enableEditModels: manageIfcModelsAllowed,\n          },\n          this.ifcData.projects,\n        );\n      });\n  }\n\n  ngAfterViewInit():void {\n    this.viewInitialized$.next();\n  }\n\n  ngOnDestroy():void {\n    this.ifcViewerService.destroy();\n  }\n\n  toggleInspector():void {\n    this.ifcViewerService.inspectorVisible$.next(!this.inspectorVisible$.getValue());\n  }\n\n  // Key events for navigating the viewer shall not propagate further up in the DOM, i.e.\n  // pressing the S-key shall not trigger the global search which listens on `document`.\n  @HostListener('keydown', ['$event'])\n  @HostListener('keyup', ['$event'])\n  @HostListener('keypress', ['$event'])\n  // eslint-disable-next-line class-methods-use-this\n  cancelAllKeyEvents($event:KeyboardEvent):void {\n    $event.stopPropagation();\n  }\n\n  @HostListener('mousedown')\n  enableKeyBoard():void {\n    if (this.modelCount) {\n      this.keyboardEnabled = true;\n      this.ifcViewerService.setKeyboardEnabled(true);\n    }\n  }\n\n  @HostListener('window:mousedown', ['$event.target'])\n  disableKeyboard(target:Element):void {\n    if (this.modelCount && !(this.outerContainer.nativeElement as HTMLElement).contains(target)) {\n      this.keyboardEnabled = false;\n      this.ifcViewerService.setKeyboardEnabled(false);\n    }\n  }\n\n  enableFromIcon(event:MouseEvent):boolean {\n    this.enableKeyBoard();\n\n    // Focus on the canvas\n    (this.modelCanvas.nativeElement as HTMLElement).focus();\n\n    // Ensure we don't bubble this event to the window:mousedown handler\n    // as the target will already be removed from the DOM by angular\n    event.stopImmediatePropagation();\n    return false;\n  }\n}\n","<div class=\"op-bcf-list--result-overlay\"\n     *ngIf=\"(showResultOverlay$ | async) && showTableView\"></div>\n\n<!-- TABLE representation of the WP -->\n<div class=\"op-bcf-list--work-packages-split-view--tabletimeline-container\"\n     [ngClass]=\"{ '_with-resizer': showResizerInCardView() }\"\n     *ngIf=\"tableInformationLoaded && showTableView\">\n  <wp-resizer *ngIf=\"showResizer\"\n              elementClass=\"work-packages-partitioned-page--content-right\"\n              localStorageKey=\"openProject-splitViewFlexBasis\">\n  </wp-resizer>\n\n  <wp-table [projectIdentifier]=\"CurrentProject.identifier\"\n            [configuration]=\"wpTableConfiguration\"\n            (itemClicked)=\"handleWorkPackageClicked($event)\"\n            (stateLinkClicked)=\"openStateLink($event)\"\n            class=\"work-packages-split-view--tabletimeline-content\">\n  </wp-table>\n</div>\n\n<!-- GRID representation of the WP -->\n<div *ngIf=\"!showTableView\"\n     class=\"op-bcf-list--work-packages--card-view-container\"\n     [ngClass]=\"{ '_with-resizer': showResizerInCardView() }\">\n  <wp-grid [configuration]=\"wpTableConfiguration\"\n           [showResizer]=\"showResizerInCardView()\"\n           (itemClicked)=\"handleWorkPackageClicked($event)\"\n           (stateLinkClicked)=\"openStateLink($event)\"\n           resizerClass=\"work-packages-partitioned-page--content-right\"\n           resizerStorageKey=\"openProject-splitViewFlexBasis\">\n  </wp-grid>\n</div>\n\n<!-- Footer -->\n<div class=\"work-packages-split-view--tabletimeline-footer hide-when-print\"\n     *ngIf=\"tableInformationLoaded\">\n  <wp-table-pagination></wp-table-pagination>\n</div>","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectionStrategy, Component, Input, NgZone, OnInit,\n} from '@angular/core';\nimport { UIRouterGlobals } from '@uirouter/core';\nimport { States } from 'core-app/core/states/states.service';\nimport { InjectField } from 'core-app/shared/helpers/angular/inject-field.decorator';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { DragAndDropService } from 'core-app/shared/helpers/drag-and-drop/drag-and-drop.service';\nimport { BcfApiService } from 'core-app/features/bim/bcf/api/bcf-api.service';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { BcfViewService } from 'core-app/features/bim/ifc_models/pages/viewer/bcf-view.service';\nimport { splitViewRoute } from 'core-app/features/work-packages/routing/split-view-routes.helper';\nimport { ViewerBridgeService } from 'core-app/features/bim/bcf/bcf-viewer-bridge/viewer-bridge.service';\nimport { CausedUpdatesService } from 'core-app/features/boards/board/caused-updates/caused-updates.service';\nimport { IfcModelsDataService } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-models-data.service';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport {\n  WorkPackageListViewComponent,\n} from 'core-app/features/work-packages/routing/wp-list-view/wp-list-view.component';\nimport {\n  WorkPackageViewColumnsService,\n} from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-columns.service';\nimport {\n  WorkPackageNotificationService,\n} from 'core-app/features/work-packages/services/notifications/work-package-notification.service';\n\n@Component({\n  templateUrl: './bcf-list.component.html',\n  styleUrls: ['./bcf-list.component.sass'],\n  providers: [\n    { provide: HalResourceNotificationService, useClass: WorkPackageNotificationService },\n    DragAndDropService,\n    CausedUpdatesService,\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'op-bcf-list',\n})\nexport class BcfListComponent extends WorkPackageListViewComponent implements UntilDestroyedMixin, OnInit {\n  @Input() showResizer = false;\n\n  @InjectField() bcfView:BcfViewService;\n\n  @InjectField() ifcModelsService:IfcModelsDataService;\n\n  @InjectField() wpTableColumns:WorkPackageViewColumnsService;\n\n  @InjectField() uIRouterGlobals:UIRouterGlobals;\n\n  @InjectField() viewer:ViewerBridgeService;\n\n  @InjectField() states:States;\n\n  @InjectField() bcfApi:BcfApiService;\n\n  @InjectField() zone:NgZone;\n\n  public wpTableConfiguration = {\n    dragAndDropEnabled: false,\n  };\n\n  public showViewPointInFlight:boolean;\n\n  ngOnInit():void {\n    super.ngOnInit();\n  }\n\n  protected updateViewRepresentation(query:QueryResource):void {\n    const viewerState = this.bcfView.valueFromQuery(query);\n    this.showTableView = !this.deviceService.isMobile\n      && (viewerState === 'table' || viewerState === 'splitTable');\n  }\n\n  public showResizerInCardView():boolean {\n    if (this.noResults && this.ifcModelsService.models.length === 0) {\n      return false;\n    }\n\n    return this.bcfView.currentViewerState() === 'splitCards'\n      || this.bcfView.currentViewerState() === 'splitTable';\n  }\n\n  handleWorkPackageClicked(event:{ workPackageId:string; double:boolean }):void {\n    const { workPackageId, double } = event;\n\n    if (!this.showViewPointInFlight) {\n      this.showViewPointInFlight = true;\n\n      this.zone.runOutsideAngular(() => {\n        setTimeout(() => { this.showViewPointInFlight = false; }, 500);\n      });\n\n      const wp = this.states.workPackages.get(workPackageId).value;\n\n      if (wp && this.viewer.viewerVisible() && wp.bcfViewpoints) {\n        this.viewer.showViewpoint(wp, 0);\n      }\n    }\n\n    if (double || this.deviceService.isMobile) {\n      this.goToWpDetailState(workPackageId, this.uIRouterGlobals.params.cards);\n    }\n  }\n\n  openStateLink(event:{ workPackageId:string; requestedState:string }):void {\n    this.goToWpDetailState(event.workPackageId, this.uIRouterGlobals.params.cards, true);\n  }\n\n  goToWpDetailState(workPackageId:string, cards:boolean, focus?:boolean):void {\n    // Show the split view when there is a viewer (browser)\n    // Show only wp details when there is no viewer, plugin environment (ie: Revit)\n    const stateToGo = this.viewer.shouldShowViewer\n      ? splitViewRoute(this.$state)\n      : 'bim.partitioned.show';\n    // Passing the card param to the new state because the router doesn't keep\n    // it when going to 'bim.partitioned.show'\n    const params = { workPackageId, cards, focus };\n\n    void this.$state.go(stateToGo, params);\n  }\n}\n","<op-ifc-viewer\n  *ngIf=\"showViewer$ | async\"\n></op-ifc-viewer>\n\n<op-bcf-list\n  *ngIf=\"(showViewer$ | async) === false\"\n></op-bcf-list>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  OnInit,\n} from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { BcfViewService } from 'core-app/features/bim/ifc_models/pages/viewer/bcf-view.service';\n\n@Component({\n  templateUrl: './bcf-split-left.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'op-bcf-content-left',\n})\nexport class BcfSplitLeftComponent implements OnInit {\n  showViewer$:Observable<boolean>;\n\n  constructor(private readonly bcfView:BcfViewService) {}\n\n  ngOnInit():void {\n    this.showViewer$ = this.bcfView.live$()\n      .pipe(\n        map((state) => state !== 'cards' && state !== 'table'),\n      );\n  }\n}\n","<op-bcf-list\n  [showResizer]=\"true\"\n  *ngIf=\"showWorkPackages$ | async\"\n></op-bcf-list>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  OnInit,\n} from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { BcfViewService } from 'core-app/features/bim/ifc_models/pages/viewer/bcf-view.service';\nimport { map } from 'rxjs/operators';\n\n@Component({\n  templateUrl: './bcf-split-right.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'op-bcf-content-right',\n})\nexport class BcfSplitRightComponent implements OnInit {\n  showWorkPackages$:Observable<boolean>;\n\n  constructor(private readonly bcfView:BcfViewService) {}\n\n  ngOnInit():void {\n    this.showWorkPackages$ = this.bcfView.live$()\n      .pipe(\n        map((state) => state === 'splitTable' || state === 'splitCards'),\n      );\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { Ng2StateDeclaration } from '@uirouter/angular';\nimport { IFCViewerPageComponent } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-viewer-page.component';\nimport { makeSplitViewRoutes } from 'core-app/features/work-packages/routing/split-view-routes.template';\nimport { WorkPackageSplitViewComponent } from 'core-app/features/work-packages/routing/wp-split-view/wp-split-view.component';\nimport { WorkPackageNewFullViewComponent } from 'core-app/features/work-packages/components/wp-new/wp-new-full-view.component';\nimport { WorkPackagesBaseComponent } from 'core-app/features/work-packages/routing/wp-base/wp--base.component';\nimport { BcfSplitLeftComponent } from 'core-app/features/bim/ifc_models/bcf/split/left/bcf-split-left.component';\nimport { BcfSplitRightComponent } from 'core-app/features/bim/ifc_models/bcf/split/right/bcf-split-right.component';\n\nexport const IFC_ROUTES:Ng2StateDeclaration[] = [\n  {\n    name: 'bim',\n    parent: 'optional_project',\n    url: '/bcf?query_id&query_props&models&viewpoint',\n    abstract: true,\n    component: WorkPackagesBaseComponent,\n    redirectTo: 'bim.partitioned.list',\n    params: {\n      // Use custom encoder/decoder that ensures validity of URL string\n      query_id: { type: 'query', dynamic: true },\n      query_props: { type: 'opQueryString', dynamic: true },\n      models: { type: 'opQueryString', dynamic: true },\n      viewpoint: { type: 'int', dynamic: true },\n    },\n  },\n  {\n    name: 'bim.partitioned',\n    redirectTo: 'bim.partitioned.list',\n    url: '',\n    component: IFCViewerPageComponent,\n    data: {\n      bodyClasses: 'router--bim',\n    },\n  },\n  {\n    name: 'bim.partitioned.list',\n    url: '',\n    data: {\n      baseRoute: 'bim.partitioned.list',\n      newRoute: 'bim.partitioned.list.new',\n      partition: '-split',\n    },\n    reloadOnSearch: false,\n    views: {\n      'content-left': { component: BcfSplitLeftComponent },\n      'content-right': { component: BcfSplitRightComponent },\n    },\n  },\n  {\n    name: 'bim.partitioned.new',\n    url: '/new?type&parent_id',\n    reloadOnSearch: false,\n    data: {\n      baseRoute: 'bim.partitioned.list',\n      allowMovingInEditMode: true,\n      partition: '-left-only',\n      successState: 'bim.partitioned.show',\n    },\n    views: { 'content-left': { component: WorkPackageNewFullViewComponent } },\n  },\n  {\n    name: 'bim.partitioned.show',\n    url: '/show/{workPackageId:[0-9]+}',\n    data: {\n      baseRoute: 'bim.partitioned.list',\n      partition: '-left-only',\n    },\n    reloadOnSearch: false,\n    redirectTo: 'bim.partitioned.show.details',\n  },\n  // BCF full view detail routes for usage in revit addi-in\n  ...makeSplitViewRoutes(\n    'bim.partitioned.list',\n    undefined,\n    WorkPackageSplitViewComponent,\n    undefined,\n    true,\n    false,\n    'bim.partitioned.show',\n  ),\n  // BCF split view detail routes\n  ...makeSplitViewRoutes(\n    'bim.partitioned.list',\n    undefined,\n    WorkPackageSplitViewComponent,\n    undefined,\n    false,\n    false,\n  ),\n];\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\nimport { NgModule } from '@angular/core';\nimport { OpenprojectWorkPackagesModule } from 'core-app/features/work-packages/openproject-work-packages.module';\nimport { UIRouterModule } from '@uirouter/angular';\nimport { OPSharedModule } from 'core-app/shared/shared.module';\nimport { IFC_ROUTES } from 'core-app/features/bim/ifc_models/openproject-ifc-models.routes';\nimport { IFCViewerPageComponent } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-viewer-page.component';\nimport { BcfViewToggleButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/view-toggle/bcf-view-toggle-button.component';\nimport { BcfViewToggleDropdownDirective } from 'core-app/features/bim/ifc_models/toolbar/view-toggle/bcf-view-toggle-dropdown.directive';\nimport { BimManageIfcModelsButtonComponent } from 'core-app/features/bim/ifc_models/toolbar/manage-ifc-models-button/bim-manage-ifc-models-button.component';\nimport { IFCViewerService } from 'core-app/features/bim/ifc_models/ifc-viewer/ifc-viewer.service';\nimport { OpenprojectFieldsModule } from 'core-app/shared/components/fields/openproject-fields.module';\nimport { BcfListComponent } from 'core-app/features/bim/ifc_models/bcf/list/bcf-list.component';\nimport { IfcModelsDataService } from 'core-app/features/bim/ifc_models/pages/viewer/ifc-models-data.service';\nimport { OpenprojectBcfModule } from 'core-app/features/bim/bcf/openproject-bcf.module';\nimport { OpenprojectHalModule } from 'core-app/features/hal/openproject-hal.module';\nimport { IFCViewerComponent } from './ifc-viewer/ifc-viewer.component';\nimport { BcfSplitLeftComponent } from 'core-app/features/bim/ifc_models/bcf/split/left/bcf-split-left.component';\nimport { BcfSplitRightComponent } from 'core-app/features/bim/ifc_models/bcf/split/right/bcf-split-right.component';\n\n@NgModule({\n  imports: [\n    OPSharedModule,\n    OpenprojectFieldsModule,\n    OpenprojectHalModule,\n    OpenprojectBcfModule,\n    OpenprojectWorkPackagesModule,\n    UIRouterModule.forChild({\n      states: IFC_ROUTES,\n    }),\n  ],\n  providers: [\n    IFCViewerService,\n    IfcModelsDataService,\n  ],\n  declarations: [\n    // Pages\n    IFCViewerPageComponent,\n\n    // Regions of pages\n    BcfSplitLeftComponent,\n    BcfSplitRightComponent,\n    BcfListComponent,\n\n    // Toolbar\n    BimManageIfcModelsButtonComponent,\n    BcfViewToggleButtonComponent,\n    BcfViewToggleDropdownDirective,\n\n    IFCViewerComponent,\n  ],\n})\nexport class OpenprojectIFCModelsModule {\n}\n"],"sourceRoot":"webpack:///","file":"src_app_features_bim_ifc_models_openproject-ifc-models_module_ts.18e91db4360fd03f201a.js"}